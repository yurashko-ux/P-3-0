(()=>{var e={};e.id=8996,e.ids=[8996],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4356:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),r(2953),r(2675),r(5866);var l=r(3191),a=r(8716),n=r(7922),s=r.n(n),i=r(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let d=["",{children:["admin",{children:["tools",{children:["ingest",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2953)),"/Users/mykolay/P-3-0/web/app/admin/tools/ingest/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,2675)),"/Users/mykolay/P-3-0/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/mykolay/P-3-0/web/app/admin/tools/ingest/page.tsx"],u="/admin/tools/ingest/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new l.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/tools/ingest/page",pathname:"/admin/tools/ingest",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4808:(e,t,r)=>{Promise.resolve().then(r.bind(r,2864))},6847:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},5800:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,4064,23))},2864:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,dynamic:()=>n});var l=r(326),a=r(7577);let n="force-dynamic";function s({title:e,children:t}){return(0,l.jsxs)("div",{className:"rounded-2xl border p-4 md:p-6",children:[l.jsx("h2",{className:"mb-3 text-lg font-semibold",children:e}),t]})}function i({label:e,value:t,setValue:r,placeholder:a,type:n="text"}){return(0,l.jsxs)("label",{className:"flex flex-col gap-1",children:[l.jsx("span",{className:"text-sm text-gray-600",children:e}),l.jsx("input",{type:n,value:t,onChange:e=>r(e.target.value),placeholder:a,className:"rounded-lg border px-3 py-2 text-sm outline-none"})]})}function o(){let[e,t]=(0,a.useState)(""),[r,n]=(0,a.useState)(""),[o,d]=(0,a.useState)(""),[c,u]=(0,a.useState)(""),[p,m]=(0,a.useState)(null),[b,g]=(0,a.useState)(!1),[f,y]=(0,a.useState)(""),[h,x]=(0,a.useState)(""),[v,j]=(0,a.useState)(""),[P,w]=(0,a.useState)(null),[S,_]=(0,a.useState)(!1),[N,R]=(0,a.useState)(""),[k,O]=(0,a.useState)(""),[D,C]=(0,a.useState)(null),[T,q]=(0,a.useState)(!1);async function G(t){t.preventDefault(),g(!0),m(null);try{let t=new URLSearchParams;e&&t.set("token",e),c&&t.set("card_id",c);let l=await fetch(`/api/mc/ingest?${t.toString()}`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:r,text:o})}),a=await l.json();m(a)}catch(e){m({ok:!1,error:String(e)})}finally{g(!1)}}async function I(e){e.preventDefault(),_(!0),w(null);try{let e=await fetch("/api/keycrm/card/move",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({card_id:f,to_pipeline_id:h,to_status_id:v})}),t=await e.json();w(t)}catch(e){w({ok:!1,error:String(e)})}finally{_(!1)}}async function M(e){e.preventDefault(),q(!0),C(null);try{let e=await fetch("/api/map/ig",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:N,card_id:k})}),t=await e.json();C(t)}catch(e){C({ok:!1,error:String(e)})}finally{q(!1)}}async function A(){q(!0),C(null);try{let e=await fetch(`/api/map/ig?username=${encodeURIComponent(N)}`,{credentials:"include"}),t=await e.json();C(t)}catch(e){C({ok:!1,error:String(e)})}finally{q(!1)}}return(0,l.jsxs)("div",{className:"mx-auto max-w-4xl px-4 py-6",children:[(0,l.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[l.jsx("h1",{className:"text-2xl font-bold",children:"Admin Tools"}),l.jsx("a",{href:"/admin/campaigns",className:"rounded-full border px-3 py-1.5 text-sm",children:"← До кампаній"})]}),(0,l.jsxs)("div",{className:"grid gap-6",children:[(0,l.jsxs)(s,{title:"Map username → card_id (/api/map/ig)",children:[(0,l.jsxs)("form",{onSubmit:M,className:"grid gap-3",children:[(0,l.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[l.jsx(i,{label:"username (IG)",value:N,setValue:R,placeholder:"ig_login"}),l.jsx(i,{label:"card_id",value:k,setValue:O,placeholder:"CARD_ID"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[l.jsx("button",{type:"submit",disabled:T,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",children:"Зберегти мапінг"}),l.jsx("button",{type:"button",onClick:A,disabled:T||!N,className:"rounded-lg border px-3 py-2 text-sm",children:"Перевірити мапінг"}),l.jsx("button",{type:"button",className:"rounded-lg border px-3 py-2 text-sm",onClick:()=>C(null),children:"Очистити"})]})]}),D&&l.jsx("pre",{className:"mt-3 overflow-auto rounded-lg border bg-gray-50 p-3 text-xs",children:JSON.stringify(D,null,2)})]}),(0,l.jsxs)(s,{title:"ManiChat → /api/mc/ingest (POST)",children:[(0,l.jsxs)("form",{onSubmit:G,className:"grid gap-3",children:[(0,l.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[l.jsx(i,{label:"MC_TOKEN",value:e,setValue:t,placeholder:"секрет токен"}),l.jsx(i,{label:"card_id (опц., швидкий тест)",value:c,setValue:u,placeholder:"CARD_ID"})]}),(0,l.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[l.jsx(i,{label:"username (IG)",value:r,setValue:n,placeholder:"ig_login"}),l.jsx(i,{label:"text",value:o,setValue:d,placeholder:"yes / ключове слово"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[l.jsx("button",{type:"submit",disabled:b,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",children:"Відправити ingest"}),l.jsx("button",{type:"button",className:"rounded-lg border px-3 py-2 text-sm",onClick:()=>m(null),children:"Очистити"})]})]}),p&&l.jsx("pre",{className:"mt-3 overflow-auto rounded-lg border bg-gray-50 p-3 text-xs",children:JSON.stringify(p,null,2)})]}),(0,l.jsxs)(s,{title:"KeyCRM Move → /api/keycrm/card/move (POST)",children:[(0,l.jsxs)("form",{onSubmit:I,className:"grid gap-3",children:[(0,l.jsxs)("div",{className:"grid gap-3 md:grid-cols-3",children:[l.jsx(i,{label:"card_id",value:f,setValue:y,placeholder:"CARD_ID"}),l.jsx(i,{label:"to_pipeline_id",value:h,setValue:x,placeholder:"PID"}),l.jsx(i,{label:"to_status_id",value:v,setValue:j,placeholder:"SID"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[l.jsx("button",{type:"submit",disabled:S,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-700 disabled:opacity-60",children:"Тест move"}),l.jsx("button",{type:"button",className:"rounded-lg border px-3 py-2 text-sm",onClick:()=>w(null),children:"Очистити"})]})]}),P&&l.jsx("pre",{className:"mt-3 overflow-auto rounded-lg border bg-gray-50 p-3 text-xs",children:JSON.stringify(P,null,2)})]})]})]})}},2953:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>s,__esModule:()=>n,default:()=>o,dynamic:()=>i});var l=r(8570);let a=(0,l.createProxy)(String.raw`/Users/mykolay/P-3-0/web/app/admin/tools/ingest/page.tsx`),{__esModule:n,$$typeof:s}=a;a.default;let i=(0,l.createProxy)(String.raw`/Users/mykolay/P-3-0/web/app/admin/tools/ingest/page.tsx#dynamic`),o=(0,l.createProxy)(String.raw`/Users/mykolay/P-3-0/web/app/admin/tools/ingest/page.tsx#default`)},2675:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,metadata:()=>d});var l=r(9510),a=r(18),n=r.n(a);r(7272);var s=r(9720);function i(e=globalThis){let t=(e,t)=>{if("get"in e||"set"in e){let r=e.get?e.get.bind(t):void 0,l=e.set?e.set.bind(t):void 0;return{configurable:e.configurable,enumerable:e.enumerable??!1,get:r,set:l}}if("function"==typeof e.value){let r=e.value.bind(t);return{configurable:e.configurable,enumerable:e.enumerable??!1,writable:e.writable??!1,value:r}}return e},r=(e,t,r,l)=>{let a=t?.enumerable??!1;if(t&&("get"in t||"set"in t)){let n=t.get?t.get.bind(l):void 0,s=t.set?t.set.bind(l):void 0;return{configurable:!0,enumerable:a,get:()=>r.has(e)?void 0:n?n():void 0,set:t=>{r.delete(e),s&&s(t)}}}let n=t?t.value:void 0;return{configurable:!0,enumerable:a,get:()=>r.has(e)?void 0:n,set:t=>{r.delete(e),n=t}}};if(!e||e.__p30SymbolGuarded)return;let l=(e=>{let t=e.Symbol;return"function"==typeof t?t:void 0})(e);if(!l){e.__p30SymbolGuarded=!0;return}let a=new Set(["dispose","asyncDispose"]);l.dispose&&a.add(l.dispose),l.asyncDispose&&a.add(l.asyncDispose);let n=new Set,s=function(e){return l(e)};try{Reflect.defineProperty(s,"name",{configurable:!0,enumerable:!1,writable:!1,value:"Symbol"})}catch{}try{Reflect.defineProperty(s,"length",{configurable:!0,enumerable:!1,writable:!1,value:0})}catch{}try{Reflect.defineProperty(s,"prototype",{configurable:!1,enumerable:!1,writable:!1,value:l.prototype})}catch{}for(let e of Reflect.ownKeys(l)){let i=Reflect.getOwnPropertyDescriptor(l,e);if(i){if(a.has(e)){try{Reflect.defineProperty(s,e,r(e,i,n,l))}catch{}continue}try{Reflect.defineProperty(s,e,t(i,l))}catch{}}}Object.defineProperty(s,"__p30ProxyGuard",{configurable:!1,enumerable:!1,writable:!1,value:!0});try{Object.defineProperty(s,Symbol.toStringTag,{configurable:!0,enumerable:!1,writable:!1,value:"Symbol"})}catch{}let i=e=>!!a.has(e)&&(n.add(e),!0),o=new Proxy(s,{apply:(e,t,r)=>Reflect.apply(l,t,r),deleteProperty(e,t){if(i(t)){try{Reflect.deleteProperty(e,t)}catch{}return!0}try{return Reflect.deleteProperty(l,t)}catch{return!1}},get(e,t,r){if("__p30ProxyGuard"===t)return!0;if(a.has(t)){let l=Reflect.getOwnPropertyDescriptor(e,t);return l?"get"in l&&l.get?l.get.call(r):l.value:void 0}let n=Reflect.get(e,t,r);if("function"==typeof n)try{return n.bind(l)}catch{}return n},has:(e,t)=>a.has(t)?!n.has(t)&&Reflect.has(e,t):Reflect.has(e,t)||Reflect.has(l,t),ownKeys(e){let t=[];for(let r of Reflect.ownKeys(e))!(a.has(r)&&n.has(r))&&("string"!=typeof r&&"symbol"!=typeof r||t.includes(r)||t.push(r));return t},getOwnPropertyDescriptor(e,t){if(a.has(t)){if(n.has(t))return;let r=Reflect.getOwnPropertyDescriptor(e,t);return r&&(r.configurable=!0),r}return Reflect.getOwnPropertyDescriptor(e,t)},set:(e,t,r,l)=>(a.has(t)&&n.delete(t),Reflect.set(e,t,r,l)),defineProperty(e,t,s){if(a.has(t)){n.delete(t);let a=r(t,s,n,l);return Reflect.defineProperty(e,t,a)}return Reflect.defineProperty(e,t,s)}});try{Object.defineProperty(e,"Symbol",{configurable:!0,enumerable:!1,writable:!0,value:o})}catch{e.Symbol=o}let d=function(){};try{Object.defineProperty(e,"lockdown",{configurable:!0,enumerable:!1,writable:!0,value:d})}catch{e.lockdown=d}let c=e.ses;if(c)try{Object.defineProperty(c,"lockdown",{configurable:!0,enumerable:!1,writable:!0,value:d})}catch{c.lockdown=d}"function"!=typeof e.harden&&(e.harden=e=>e),e.__p30SymbolGuarded=!0}let o=`;(${i.toString()})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : undefined);`;i();let d={title:"P-3-0",description:"Admin console"};function c({children:e}){return(0,l.jsxs)("html",{lang:"uk",className:n().className,children:[l.jsx("head",{children:l.jsx(s.default,{id:"p30-lockdown-guard",strategy:"beforeInteractive",dangerouslySetInnerHTML:{__html:o}})}),l.jsx("body",{children:e})]})}},7272:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),l=t.X(0,[8948,4818],()=>r(4356));module.exports=l})();