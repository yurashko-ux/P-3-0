(()=>{var e={};e.id=6675,e.ids=[6675],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3949:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>s.a,__next_app__:()=>p,originalPathname:()=>g,pages:()=>c,routeModule:()=>h,tree:()=>d}),t(8838),t(5866),t(2675);var i=t(3191),n=t(8716),o=t(7922),s=t.n(o),a=t(5231),l={};for(let e in a)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>a[e]);t.d(r,l);let d=["",{children:["(admin)",{children:["admin",{children:["altegio",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,8838)),"/Users/mykolay/P-3-0/web/app/(admin)/admin/altegio/page.tsx"]}]},{}]},{}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,2675)),"/Users/mykolay/P-3-0/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/mykolay/P-3-0/web/app/(admin)/admin/altegio/page.tsx"],g="/(admin)/admin/altegio/page",p={require:t,loadChunk:()=>Promise.resolve()},h=new i.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(admin)/admin/altegio/page",pathname:"/admin/altegio",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5034:(e,r,t)=>{Promise.resolve().then(t.bind(t,5638))},6847:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},5800:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,4064,23))},5638:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var i=t(326),n=t(9404),o=t.n(n),s=t(7577);function a(){let[e,r]=(0,s.useState)({loading:!1,ok:null}),[t,n]=(0,s.useState)({loading:!1,ok:null}),[a,d]=(0,s.useState)({loading:!1,ok:null}),[c,g]=(0,s.useState)({loading:!1,ok:null}),[p,h]=(0,s.useState)({loading:!1,ok:null}),[m,f]=(0,s.useState)({loading:!1,ok:null}),[x,u]=(0,s.useState)({loading:!1,ok:null}),[y,b]=(0,s.useState)({loading:!1,ok:null}),[j,k]=(0,s.useState)(""),[v,D]=(0,s.useState)(!1),[S,w]=(0,s.useState)(null),[I,C]=(0,s.useState)(!1),[T,R]=(0,s.useState)(null),[A,E]=(0,s.useState)(!1),[P,$]=(0,s.useState)({open:!1,title:"",content:""}),[z,W]=(0,s.useState)(null),[B,N]=(0,s.useState)(!1),[_,O]=(0,s.useState)(""),[F,L]=(0,s.useState)({loading:!1,ok:null});async function M(){j&&(await navigator.clipboard.writeText(j),D(!0),setTimeout(()=>D(!1),2e3))}async function U(){r({loading:!0,ok:null});try{let e=await fetch("/api/altegio/test",{cache:"no-store"}),t=await e.json();r({loading:!1,ok:!0===t.ok,message:t.message||t.error,companiesCount:t.count,companies:t.companies||[],error:t.error,env:t.env,debug:t.debug,programType:t.programType,recommendation:t.recommendation})}catch(e){r({loading:!1,ok:!1,message:"Помилка з'єднання",error:e instanceof Error?e.message:"Невідома помилка"})}}async function K(){w(null);try{let e=await fetch("/api/altegio/diagnostics",{cache:"no-store"}),r=await e.json();r.ok&&r.diagnostics&&w(r.diagnostics)}catch(e){console.error("Failed to get diagnostics:",e)}}async function H(){if(S){let e=JSON.stringify(S,null,2);await navigator.clipboard.writeText(e),C(!0),setTimeout(()=>C(!1),2e3)}}async function J(){n({loading:!0,ok:null});try{let e=await fetch("/api/altegio/test/clients",{cache:"no-store"}),r=await e.json();n({loading:!1,ok:!0===r.ok,message:r.message||r.error,clientsCount:r.clientsCount,clients:r.clients||[],firstClientStructure:r.firstClientStructure,instagramFieldFound:r.instagramFieldFound,instagramFieldName:r.instagramFieldName,instagramFieldValue:r.instagramFieldValue,allKeys:r.allKeys,customFields:r.customFields,error:r.error})}catch(e){n({loading:!1,ok:!1,message:"Помилка з'єднання",error:e instanceof Error?e.message:"Невідома помилка"})}}async function V(){E(!0),R(null);try{let e=await fetch("/api/altegio/test/clients-debug",{cache:"no-store"}),r=await e.json();R(r)}catch(e){R({ok:!1,error:e instanceof Error?e.message:"Невідома помилка"})}finally{E(!1)}}async function G(e){N(!0),W(null);try{let r=await fetch(`/api/altegio/test/clients/${e}`,{cache:"no-store"}),t=await r.json();W(t)}catch(e){W({ok:!1,error:e instanceof Error?e.message:"Невідома помилка"})}finally{N(!1)}}async function Y(){if(_.trim()){L({loading:!0,ok:null});try{let e=await fetch(`/api/altegio/test/clients/by-instagram?instagram=${encodeURIComponent(_.trim())}`,{cache:"no-store"}),r=await e.json();r.ok&&r.client?L({loading:!1,ok:!0,client:r.client}):L({loading:!1,ok:!1,error:r.error||"Клієнт не знайдено",diagnostics:r.diagnostics,similarMatches:r.similarMatches,sampleEmails:r.sampleEmails})}catch(e){L({loading:!1,ok:!1,error:e instanceof Error?e.message:"Невідома помилка"})}}}async function q(){d({loading:!0,ok:null});try{let e=await fetch("/api/altegio/test/appointments?days=30",{cache:"no-store"}),r=await e.json();d({loading:!1,ok:!0===r.ok,message:r.message||r.error,appointmentsCount:r.appointmentsCount,appointmentsWithInstagram:r.appointmentsWithInstagram,appointments:r.appointments||[],days:r.days,error:r.error})}catch(e){d({loading:!1,ok:!1,message:"Помилка з'єднання з API записів",error:e instanceof Error?e.message:"Невідома помилка"})}}async function X(){g({loading:!0,ok:null});try{let e=await fetch("/api/altegio/test/appointments/full-week",{cache:"no-store"}),r=await e.json();g({loading:!1,ok:!0===r.ok,data:r,error:r.error})}catch(e){g({loading:!1,ok:!1,error:e instanceof Error?e.message:"Невідома помилка"})}}async function Q(e="pending"){h({loading:!0,ok:null});try{let r=await fetch(`/api/altegio/reminders/queue?status=${e}&limit=50`,{cache:"no-store"}),t=await r.json();h({loading:!1,ok:!0===t.ok,jobs:t.jobs||[],debug:t.debug,error:t.error})}catch(e){h({loading:!1,ok:!1,error:e instanceof Error?e.message:"Невідома помилка"})}}async function Z(){f({loading:!0,ok:null,data:void 0,error:void 0});try{let e=await fetch("/api/altegio/reminders/debug",{cache:"no-store"});if(!e.ok)throw Error(`HTTP ${e.status}: ${e.statusText}`);let r=await e.json();f({loading:!1,ok:!0===r.ok,data:r.diagnostics,error:r.error})}catch(e){console.error("[loadRemindersDebug] Error:",e),f({loading:!1,ok:!1,error:e instanceof Error?e.message:"Невідома помилка",data:void 0})}}async function ee(){u({loading:!0,ok:null,logs:void 0,error:void 0});try{let e=await fetch("/api/altegio/reminders/sent?limit=50",{cache:"no-store"}),r=await e.json();u({loading:!1,ok:!0===r.ok,logs:r.logs||[],total:r.total||0,error:r.error})}catch(e){u({loading:!1,ok:!1,error:e instanceof Error?e.message:"Невідома помилка",logs:void 0})}}async function er(){b({loading:!0,ok:null,rules:void 0,error:void 0});try{let e=await fetch("/api/altegio/reminders/rules",{cache:"no-store"}),r=await e.json();b({loading:!1,ok:!0===r.ok,rules:r.rules||[],error:r.error})}catch(e){b({loading:!1,ok:!1,error:e instanceof Error?e.message:"Невідома помилка",rules:void 0})}}async function et(){if(y.rules){b({...y,loading:!0});try{let e=await fetch("/api/altegio/reminders/rules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rules:y.rules})}),r=await e.json();r.ok?(b({loading:!1,ok:!0,rules:r.rules||y.rules,error:void 0}),alert("✅ Шаблони повідомлень збережено!")):(b({...y,loading:!1,ok:!1,error:r.error}),alert(`❌ Помилка: ${r.error}`))}catch(e){b({...y,loading:!1,ok:!1,error:e instanceof Error?e.message:"Невідома помилка"}),alert(`❌ Помилка: ${e instanceof Error?e.message:"Невідома помилка"}`)}}}return(0,i.jsxs)("main",{style:{maxWidth:960,margin:"48px auto",padding:"0 20px"},children:[(0,i.jsxs)("header",{style:{marginBottom:28},children:[i.jsx("h1",{style:{fontSize:40,fontWeight:800,letterSpacing:-.5,margin:0},children:"Альтеджіо \xb7 аналітика"}),i.jsx("p",{style:{marginTop:10,color:"rgba(0,0,0,0.55)"},children:"Модуль у розробці: синхронізація Alteg.io, план/факт, склад волосся, нагадування."})]}),(0,i.jsxs)("section",{style:{display:"grid",gap:18},children:[(0,i.jsxs)(l,{title:"Підключення до API",emoji:"\uD83D\uDD0C",children:[(0,i.jsxs)("div",{style:{marginBottom:16},children:[i.jsx("p",{style:{marginBottom:12},children:"Перевірка підключення до Alteg.io API з використанням USER_TOKEN."}),i.jsx("button",{onClick:U,disabled:e.loading,style:{padding:"10px 20px",background:"#2a6df5",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:e.loading?"not-allowed":"pointer",opacity:e.loading?.6:1},children:e.loading?"Перевірка...":"Тестувати підключення"})]}),(0,i.jsxs)("div",{style:{marginTop:16,padding:12,background:"#f3f5f9",borderRadius:8},children:[i.jsx("p",{style:{margin:0,marginBottom:8,fontWeight:600},children:"URL для webhook в налаштуваннях Alteg.io:"}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[i.jsx("code",{style:{flex:1,padding:"8px 12px",background:"#fff",borderRadius:6,border:"1px solid #e8ebf0",fontSize:"0.9em",wordBreak:"break-all",display:"block"},children:j||"/api/altegio/webhook"}),i.jsx("button",{onClick:M,style:{padding:"8px 16px",background:v?"#22c55e":"#2a6df5",color:"#fff",border:"none",borderRadius:6,fontWeight:600,cursor:"pointer",whiteSpace:"nowrap",transition:"background 0.2s"},children:v?"✓ Скопійовано":"Скопіювати"})]}),(0,i.jsxs)("p",{style:{margin:"8px 0 0 0",fontSize:"0.9em",color:"rgba(0,0,0,0.6)"},children:["Скопіюйте цю адресу та вкажіть її в полі ",i.jsx("strong",{children:'"Адреса для надсилання повідомлень"'}),' в налаштуваннях маркетплейсу Alteg.io (розділ "Налаштування для розробки").']})]}),null!==e.ok&&(0,i.jsxs)("div",{style:{padding:12,borderRadius:8,background:e.ok?"#f0fdf4":"#fef2f2",border:`1px solid ${e.ok?"#86efac":"#fca5a5"}`,color:e.ok?"#166534":"#991b1b"},children:[(0,i.jsxs)("strong",{children:[e.ok?"✅ Успішно":"❌ Помилка",":"]})," ",e.message,void 0!==e.companiesCount&&(0,i.jsxs)("div",{style:{marginTop:8},children:["Знайдено компаній: ",i.jsx("strong",{children:e.companiesCount})]}),e.ok&&e.companies&&e.companies.length>0&&(0,i.jsxs)("div",{style:{marginTop:16,padding:12,background:"#f0f9ff",borderRadius:6,border:"1px solid #bae6fd"},children:[i.jsx("strong",{style:{display:"block",marginBottom:12},children:"\uD83D\uDCCB Список компаній (філій/салонів):"}),(0,i.jsxs)("div",{style:{maxHeight:"400px",overflowY:"auto",fontSize:"0.9em"},children:[(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #e0e7ef",textAlign:"left"},children:[i.jsx("th",{style:{padding:"8px 12px",fontWeight:600},children:"ID"}),i.jsx("th",{style:{padding:"8px 12px",fontWeight:600},children:"Назва"}),i.jsx("th",{style:{padding:"8px 12px",fontWeight:600},children:"Статус"})]})}),i.jsx("tbody",{children:e.companies.slice(0,50).map((e,r)=>(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #f0f0f0",backgroundColor:r%2==0?"#fff":"#fafafa"},children:[i.jsx("td",{style:{padding:"8px 12px",fontFamily:"monospace",fontSize:"0.85em"},children:e.id||e.company_id||"N/A"}),i.jsx("td",{style:{padding:"8px 12px"},children:e.name||e.public_title||e.title||"Без назви"}),i.jsx("td",{style:{padding:"8px 12px"},children:void 0!==e.active?!0===e.active||1===e.active?i.jsx("span",{style:{color:"#22c55e",fontWeight:600},children:"✅ Активна"}):i.jsx("span",{style:{color:"#ef4444",fontWeight:600},children:"❌ Неактивна"}):i.jsx("span",{style:{color:"#6b7280"},children:"—"})})]},e.id||r))})]}),e.companies.length>50&&(0,i.jsxs)("p",{style:{marginTop:12,fontSize:"0.85em",color:"#6b7280",textAlign:"center"},children:["Показано перші 50 з ",e.companies.length," компаній"]})]}),e.companiesCount&&e.companiesCount!==e.companies.length&&(0,i.jsxs)("p",{style:{marginTop:8,fontSize:"0.85em",color:"#6b7280"},children:["⚠️ Увага: API повернув ",e.companies.length," компаній, але count = ",e.companiesCount]}),e.companies&&e.companies.length>1&&(0,i.jsxs)("div",{style:{marginTop:12,padding:12,background:"#fff3cd",borderRadius:6,border:"1px solid #ffc107"},children:[i.jsx("strong",{children:"\uD83D\uDCA1 Якщо серед компаній є ваш салон:"}),i.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"0.9em"},children:"Якщо ви бачите тут більше компаній, ніж очікували, це означає, що API повертає всі компанії, до яких має доступ ваш User Token."}),i.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"0.9em",fontWeight:600},children:"Щоб показувати тільки ваш салон:"}),(0,i.jsxs)("ol",{style:{margin:"8px 0 0 0",paddingLeft:20,fontSize:"0.9em"},children:[i.jsx("li",{children:"Знайдіть ID вашого салону в таблиці вище"}),(0,i.jsxs)("li",{children:["Додайте змінну ",i.jsx("code",{children:"ALTEGIO_COMPANY_ID"})," в Vercel з ID вашого салону"]}),i.jsx("li",{children:"Або відфільтруйте компанії за назвою в налаштуваннях"})]}),i.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"0.85em",fontStyle:"italic",color:"#6b7280"},children:'Partner ID (784) - це не ID компанії, а ID в маркетплейсі Alteg.io. ID вашої компанії (салону) - це числове значення з колонки "ID" вище.'})]})]}),e.debug&&(0,i.jsxs)("div",{style:{marginTop:8,padding:12,background:"#f0f9ff",borderRadius:6,border:"1px solid #bae6fd",fontSize:"0.85em"},children:[i.jsx("strong",{children:"\uD83D\uDD0D Діагностика:"}),(0,i.jsxs)("ul",{style:{margin:"4px 0 0 0",paddingLeft:20},children:[(0,i.jsxs)("li",{children:["Тип програми: ",i.jsx("code",{children:e.programType||"Unknown"})]}),(0,i.jsxs)("li",{children:["User Token в env: ",i.jsx("code",{children:e.debug.userTokenInEnv?"✅ Так":"❌ Ні"})]}),e.debug.userTokenInEnv&&(0,i.jsxs)("li",{children:["Довжина User Token: ",i.jsx("code",{children:e.debug.userTokenLength||0})]}),(0,i.jsxs)("li",{children:["Partner Token в env: ",i.jsx("code",{children:e.debug.partnerTokenInEnv?"✅ Так":"❌ Ні (OK for non-public)"})]}),e.debug.partnerTokenInEnv&&(0,i.jsxs)("li",{children:["Довжина Partner Token: ",i.jsx("code",{children:e.debug.partnerTokenLength||0})]}),(0,i.jsxs)("li",{children:["Partner ID в env: ",i.jsx("code",{children:e.debug.partnerIdInEnv?"✅ Так":"❌ Ні"})]}),e.debug.partnerIdInEnv&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("li",{children:["Значення Partner ID: ",i.jsx("code",{children:e.debug.partnerIdValue||"not set"})]}),(0,i.jsxs)("li",{children:["Довжина Partner ID: ",i.jsx("code",{children:e.debug.partnerIdLength||0})]})]})]}),e.debug.partnerTokenInEnv&&e.error&&e.error.includes("Partner ID")&&(0,i.jsxs)("div",{style:{marginTop:12,padding:12,background:"#fff3cd",borderRadius:6,border:"1px solid #ffc107"},children:[i.jsx("strong",{children:"⚠️ Важливо:"}),(0,i.jsxs)("p",{style:{margin:"8px 0 0 0",fontSize:"0.9em"},children:["Partner Token все ще знайдено в environment variables, але для ",i.jsx("strong",{children:"непублічної програми"})," він не потрібен."]}),i.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"0.9em",fontWeight:600},children:"Якщо ви видалили ALTEGIO_PARTNER_TOKEN з Vercel, але діагностика все ще показує його:"}),(0,i.jsxs)("ol",{style:{margin:"8px 0 0 0",paddingLeft:20,fontSize:"0.9em"},children:[i.jsx("li",{children:"Перевірте, чи видалено змінну для правильного середовища (Production/Preview)"}),(0,i.jsxs)("li",{children:[i.jsx("strong",{children:"ОБОВ'ЯЗКОВО перезапустіть деплой"})," в Vercel (Redeploy)"]}),i.jsx("li",{children:"Зачекайте 1-2 хвилини після перезапуску"})]})]}),!e.debug.partnerTokenInEnv&&"Non-public (User Token only)"===e.programType&&i.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"0.9em",color:"#22c55e",fontWeight:600},children:"✅ Правильна конфігурація для непублічної програми: тільки User Token"})]}),e.error&&(0,i.jsxs)("div",{style:{marginTop:8,fontSize:"0.9em",opacity:.9},children:[i.jsx("div",{style:{marginBottom:8},children:e.error}),e.recommendation&&(0,i.jsxs)("div",{style:{marginTop:12,padding:12,background:"#fff3cd",borderRadius:6,border:"1px solid #ffc107"},children:[i.jsx("strong",{children:"\uD83D\uDCA1 Рекомендація:"}),i.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"0.9em"},children:e.recommendation})]}),(e.error.includes("Partner ID")||e.error.includes("partner")||e.error.includes("401"))&&(0,i.jsxs)("div",{style:{marginTop:12,padding:12,background:"#fff3cd",borderRadius:6,border:"1px solid #ffc107"},children:[i.jsx("strong",{children:"\uD83D\uDCA1 Як знайти Partner ID:"}),(0,i.jsxs)("p",{style:{margin:"8px 0",fontSize:"0.9em"},children:["Для ",i.jsx("strong",{children:"непублічних програм"})," Partner ID - це ID вашої філії/салону в Alteg.io (наприклад, 1169323). API використовує Partner ID, щоб знати, з якої філії брати дані."]}),i.jsx("p",{style:{margin:"8px 0",fontSize:"0.9em",fontWeight:600},children:"Для публічних програм Partner ID - це Application ID або Partner Token."}),i.jsx("p",{style:{margin:"8px 0",fontSize:"0.9em",fontWeight:600},children:"Варіант 1: ID філії/салону з вашої адмінки Alteg.io (для непублічних програм)"}),(0,i.jsxs)("ol",{style:{margin:"8px 0 0 0",paddingLeft:20},children:[i.jsx("li",{children:"Відкрийте вашу адмінку Alteg.io (https://app.alteg.io або https://alteg.io)"}),i.jsx("li",{children:"Перейдіть в налаштування філії/салону"}),(0,i.jsxs)("li",{children:["Знайдіть ",i.jsx("strong",{children:"ID філії"})," (може бути в URL або в налаштуваннях)"]}),i.jsx("li",{children:"ID філії зазвичай виглядає як числовий ID (наприклад: 1169323)"}),(0,i.jsxs)("li",{children:["Скопіюйте його та додайте як змінну середовища ",i.jsx("code",{children:"ALTEGIO_PARTNER_ID"})," в Vercel"]})]}),i.jsx("p",{style:{margin:"12px 0 8px 0",fontSize:"0.9em",fontWeight:600},children:"Варіант 2: Application ID з налаштувань додатку (для публічних програм)"}),(0,i.jsxs)("ol",{style:{margin:"8px 0 0 0",paddingLeft:20},children:[(0,i.jsxs)("li",{children:["Відкрийте ",i.jsx("a",{href:"https://marketplace.alteg.io",target:"_blank",rel:"noopener noreferrer",style:{color:"#2a6df5"},children:"Alteg.io Marketplace"})]}),i.jsx("li",{children:'Перейдіть в "Мої програми" → ваш додаток'}),(0,i.jsxs)("li",{children:["Відкрийте розділ ",i.jsx("strong",{children:'"Загальна інформація"'})]}),(0,i.jsxs)("li",{children:["Знайдіть ",i.jsx("strong",{children:"Application ID"})," (наприклад: 1193)"]}),(0,i.jsxs)("li",{children:["Скопіюйте його та додайте як змінну середовища ",i.jsx("code",{children:"ALTEGIO_PARTNER_ID"})," або ",i.jsx("code",{children:"ALTEGIO_PARTNER_TOKEN"})," в Vercel"]})]}),i.jsx("p",{style:{margin:"12px 0 8px 0",fontSize:"0.9em",fontWeight:600},children:"Варіант 2: Partner Token з налаштувань акаунта"}),(0,i.jsxs)("ol",{style:{margin:"8px 0 0 0",paddingLeft:20},children:[i.jsx("li",{children:'Натисніть на "Налаштування облікового запису" (праворуч вгорі)'}),i.jsx("li",{children:'Перейдіть в розділ "Акаунт розробника"'}),i.jsx("li",{children:'Знайдіть поле "Токен партнера" (Partner Token)'}),i.jsx("li",{children:"Якщо є - скопіюйте його"})]}),i.jsx("p",{style:{margin:"12px 0 0 0",fontSize:"0.85em",fontStyle:"italic",background:"#e7f3ff",padding:8,borderRadius:4},children:'\uD83D\uDCA1 Зазвичай Partner Token = Application ID з розділу "Загальна інформація". Наприклад, якщо Application ID = 1193, то Partner Token = "1193".'}),i.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"0.85em"},children:"Після додавання змінної середовища перезапустіть деплой або зачекайте 1-2 хвилини."})]})]})]})]}),(0,i.jsxs)(l,{title:"Пошук клієнта за Instagram",emoji:"\uD83D\uDD0D",children:[(0,i.jsxs)("div",{style:{marginBottom:16},children:[i.jsx("p",{style:{marginBottom:12},children:"Введіть Instagram username для пошуку клієнта. Система шукає в полі email (формат: instagram_username@gmail.com)."}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"flex-start",flexWrap:"wrap"},children:[i.jsx("input",{type:"text",value:_,onChange:e=>O(e.target.value),placeholder:"Наприклад: mv_valeria або @mv_valeria",onKeyPress:e=>{"Enter"===e.key&&_.trim()&&Y()},style:{flex:"1 1 300px",padding:"10px 16px",border:"1px solid #e0e7ef",borderRadius:8,fontSize:"1em",minWidth:"200px"}}),i.jsx("button",{onClick:Y,disabled:F.loading||!_.trim(),style:{padding:"10px 24px",background:F.loading||!_.trim()?"#9ca3af":"#2a6df5",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:F.loading||!_.trim()?"not-allowed":"pointer",opacity:F.loading||!_.trim()?.6:1,whiteSpace:"nowrap"},children:F.loading?"Пошук...":"Знайти"})]})]}),null!==F.ok&&i.jsx("div",{style:{padding:16,borderRadius:8,background:F.ok?"#f0fdf4":"#fef2f2",border:`1px solid ${F.ok?"#86efac":"#fca5a5"}`,color:F.ok?"#166534":"#991b1b"},children:F.ok&&F.client?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:16},children:[i.jsx("span",{style:{fontSize:"1.5em"},children:"✅"}),i.jsx("strong",{style:{fontSize:"1.1em"},children:"Клієнт знайдено!"})]}),i.jsx("div",{style:{background:"#fff",padding:16,borderRadius:8,border:"1px solid #d1d5db"},children:(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:16},children:[(0,i.jsxs)("div",{children:[i.jsx("strong",{style:{display:"block",marginBottom:4,color:"#6b7280",fontSize:"0.9em"},children:"Ім'я та прізвище:"}),i.jsx("div",{style:{fontSize:"1.1em",fontWeight:600,color:"#1f2937"},children:F.client.name||"—"})]}),(0,i.jsxs)("div",{children:[i.jsx("strong",{style:{display:"block",marginBottom:4,color:"#6b7280",fontSize:"0.9em"},children:"Номер телефону:"}),i.jsx("div",{style:{fontSize:"1.1em",fontFamily:"monospace",color:"#1f2937"},children:F.client.phone||"—"})]}),(0,i.jsxs)("div",{children:[i.jsx("strong",{style:{display:"block",marginBottom:4,color:"#6b7280",fontSize:"0.9em"},children:"Email:"}),i.jsx("div",{style:{fontSize:"1em",color:"#1f2937",wordBreak:"break-all"},children:F.client.email||"—"})]}),(0,i.jsxs)("div",{children:[i.jsx("strong",{style:{display:"block",marginBottom:4,color:"#6b7280",fontSize:"0.9em"},children:"Instagram:"}),(0,i.jsxs)("div",{style:{fontSize:"1em",fontFamily:"monospace",color:"#22c55e",fontWeight:600},children:["@",F.client.instagramUsername||"—"]})]}),(0,i.jsxs)("div",{children:[i.jsx("strong",{style:{display:"block",marginBottom:4,color:"#6b7280",fontSize:"0.9em"},children:"ID клієнта:"}),i.jsx("div",{style:{fontSize:"1em",fontFamily:"monospace",color:"#6b7280"},children:F.client.id})]})]})})]}):(0,i.jsxs)("div",{children:[i.jsx("strong",{style:{display:"block",marginBottom:8},children:"❌ Клієнт не знайдено"}),i.jsx("div",{style:{fontSize:"0.9em",opacity:.9,marginBottom:12},children:F.error||"Клієнт з таким Instagram username не знайдено в системі."}),F.diagnostics&&(0,i.jsxs)("div",{style:{padding:12,background:"#f0f9ff",borderRadius:6,border:"1px solid #bae6fd",fontSize:"0.85em",marginTop:12},children:[i.jsx("strong",{style:{display:"block",marginBottom:4},children:"\uD83D\uDCCA Діагностика:"}),(0,i.jsxs)("ul",{style:{margin:"4px 0 0 0",paddingLeft:20},children:[(0,i.jsxs)("li",{children:["Перевірено клієнтів: ",i.jsx("strong",{children:F.diagnostics.searchedClients})]}),(0,i.jsxs)("li",{children:["Клієнтів з email: ",i.jsx("strong",{children:F.diagnostics.clientsWithEmail})]}),(0,i.jsxs)("li",{children:["Клієнтів без email: ",i.jsx("strong",{children:F.diagnostics.clientsWithoutEmail})]})]})]}),F.similarMatches&&F.similarMatches.length>0&&(0,i.jsxs)("div",{style:{padding:12,background:"#fff3cd",borderRadius:6,border:"1px solid #ffc107",fontSize:"0.85em",marginTop:12},children:[i.jsx("strong",{style:{display:"block",marginBottom:4},children:"\uD83D\uDD0D Схожі збіги:"}),i.jsx("ul",{style:{margin:"4px 0 0 0",paddingLeft:20},children:F.similarMatches.map((e,r)=>(0,i.jsxs)("li",{children:[e.name||"Без імені"," - ",e.email," (Instagram: @",e.instagramPart,")"]},r))})]}),F.sampleEmails&&F.sampleEmails.length>0&&(0,i.jsxs)("details",{style:{marginTop:12},children:[i.jsx("summary",{style:{cursor:"pointer",fontWeight:600,fontSize:"0.9em"},children:"\uD83D\uDCCB Приклади email в системі (перші 10)"}),i.jsx("div",{style:{marginTop:8,padding:12,background:"#f8fafc",borderRadius:6,fontSize:"0.85em"},children:i.jsx("ul",{style:{margin:0,paddingLeft:20},children:F.sampleEmails.map((e,r)=>(0,i.jsxs)("li",{style:{marginBottom:4},children:[e.name||"Без імені"," - ",i.jsx("code",{children:e.email})," (Instagram: ",(0,i.jsxs)("code",{children:["@",e.instagramPart]}),")"]},r))})})]})]})})]}),(0,i.jsxs)(l,{title:"Тестування клієнтів",emoji:"\uD83D\uDC65",children:[(0,i.jsxs)("div",{style:{marginBottom:16},children:[i.jsx("p",{style:{marginBottom:12},children:'Перевірка отримання клієнтів та кастомного поля "Instagram user name" через API.'}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx("button",{onClick:J,disabled:t.loading,style:{padding:"10px 20px",background:"#2a6df5",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:t.loading?"not-allowed":"pointer",opacity:t.loading?.6:1},children:t.loading?"Перевірка...":"Отримати клієнтів"}),i.jsx("button",{onClick:V,disabled:A,style:{padding:"10px 20px",background:"#f59e0b",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:A?"not-allowed":"pointer",opacity:A?.6:1},children:A?"Тестування...":"\uD83D\uDD27 Діагностика API"}),i.jsx("button",{onClick:K,style:{padding:"10px 20px",background:"#6b7280",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer"},children:"\uD83D\uDD0D Діагностика для підтримки"})]})]}),S&&(0,i.jsxs)("div",{style:{marginTop:16,padding:12,background:"#f0f9ff",borderRadius:8,border:"1px solid #bae6fd"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsx("strong",{children:"\uD83D\uDCCB Діагностична інформація для техпідтримки Altegio:"}),i.jsx("button",{onClick:H,style:{padding:"6px 12px",background:I?"#22c55e":"#3b82f6",color:"#fff",border:"none",borderRadius:6,fontWeight:600,cursor:"pointer",fontSize:"0.85em"},children:I?"✓ Скопійовано":"Скопіювати JSON"})]}),i.jsx("div",{style:{padding:12,background:"#fff",borderRadius:6,fontSize:"0.85em",maxHeight:"400px",overflowY:"auto"},children:i.jsx("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-all"},children:JSON.stringify(S,null,2)})}),i.jsx("p",{style:{marginTop:12,fontSize:"0.9em",color:"#6b7280"},children:"Скопіюйте цю інформацію та надішліть її в техпідтримку Altegio для діагностики проблеми з правами доступу."})]}),null!==t.ok&&(0,i.jsxs)("div",{style:{padding:12,borderRadius:8,background:t.ok?"#f0fdf4":"#fef2f2",border:`1px solid ${t.ok?"#86efac":"#fca5a5"}`,color:t.ok?"#166534":"#991b1b"},children:[(0,i.jsxs)("strong",{children:[t.ok?"✅ Успішно":"❌ Помилка",":"]})," ",t.message,void 0!==t.clientsCount&&(0,i.jsxs)("div",{style:{marginTop:8},children:["Знайдено клієнтів: ",i.jsx("strong",{children:t.clientsCount})]}),t.ok&&t.clients&&t.clients.length>0&&(0,i.jsxs)("div",{style:{marginTop:16,padding:12,background:"#f0f9ff",borderRadius:6,border:"1px solid #bae6fd"},children:[i.jsx("strong",{style:{display:"block",marginBottom:12},children:"\uD83D\uDC65 Список клієнтів:"}),i.jsx("div",{style:{overflowX:"auto"},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9em"},children:[i.jsx("thead",{children:(0,i.jsxs)("tr",{style:{borderBottom:"2px solid #bae6fd",textAlign:"left"},children:[i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"ID"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Ім'я"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Телефон"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Email"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Instagram"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Card Number"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Note"})]})}),i.jsx("tbody",{children:t.clients.map((e,r)=>(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #e0e7ef",backgroundColor:r%2==0?"#fff":"#fafafa"},children:[i.jsx("td",{style:{padding:"8px",fontFamily:"monospace",fontSize:"0.85em"},children:e.id||"N/A"}),i.jsx("td",{style:{padding:"8px",fontWeight:500},children:(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{children:e.name||"—"}),e.id&&i.jsx("button",{onClick:()=>G(e.id),disabled:B,style:{padding:"4px 8px",background:"#f59e0b",color:"#fff",border:"none",borderRadius:4,fontSize:"0.75em",cursor:B?"not-allowed":"pointer",opacity:B?.6:1},title:"Отримати повну структуру клієнта",children:B&&z?.clientId===e.id?"...":"\uD83D\uDD0D"})]})}),i.jsx("td",{style:{padding:"8px",fontFamily:"monospace",fontSize:"0.85em"},children:e.phone||"—"}),i.jsx("td",{style:{padding:"8px",fontSize:"0.85em"},children:e.email||"—"}),i.jsx("td",{style:{padding:"8px",fontFamily:"monospace",fontSize:"0.85em"},children:e.instagram&&"—"!==e.instagram?(0,i.jsxs)("span",{style:{color:"#22c55e",fontWeight:600},children:["@",e.instagram]}):i.jsx("span",{style:{color:"#ef4444"},children:"—"})}),i.jsx("td",{style:{padding:"8px",fontFamily:"monospace",fontSize:"0.85em",color:e.cardNumber&&"—"!==e.cardNumber?"#166534":"#6b7280"},children:e.cardNumber||"—"}),i.jsx("td",{style:{padding:"8px",fontSize:"0.85em",color:e.note&&"—"!==e.note?"#166534":"#6b7280",maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis"},children:e.note||"—"})]},e.id||r))})]})})]}),t.ok&&t.firstClientStructure&&(0,i.jsxs)("div",{style:{marginTop:16,padding:12,background:"#f0f9ff",borderRadius:6,border:"1px solid #bae6fd"},children:[i.jsx("strong",{style:{display:"block",marginBottom:12},children:"\uD83D\uDCCB Структура першого клієнта:"}),t.instagramFieldFound?(0,i.jsxs)("div",{style:{padding:12,background:"#dcfce7",borderRadius:6,border:"1px solid #86efac",marginBottom:12},children:[i.jsx("strong",{style:{color:"#166534"},children:"✅ Instagram поле знайдено!"}),(0,i.jsxs)("div",{style:{marginTop:8,fontSize:"0.9em"},children:[i.jsx("strong",{children:"Назва поля:"})," ",i.jsx("code",{children:t.instagramFieldName}),i.jsx("br",{}),i.jsx("strong",{children:"Значення:"})," ",i.jsx("code",{children:t.instagramFieldValue})]})]}):(0,i.jsxs)("div",{style:{padding:12,background:"#fef3c7",borderRadius:6,border:"1px solid #fcd34d",marginBottom:12},children:[i.jsx("strong",{style:{color:"#92400e"},children:"⚠️ Instagram поле не знайдено"}),i.jsx("p",{style:{margin:"8px 0 0 0",fontSize:"0.9em"},children:"Перевірте всі можливі варіанти назв поля в структурі нижче."})]}),(0,i.jsxs)("div",{style:{marginTop:12},children:[i.jsx("strong",{children:"Основні поля:"}),(0,i.jsxs)("ul",{style:{margin:"4px 0 0 0",paddingLeft:20,fontSize:"0.9em"},children:[(0,i.jsxs)("li",{children:["ID: ",i.jsx("code",{children:t.firstClientStructure.id})]}),(0,i.jsxs)("li",{children:["Ім'я: ",i.jsx("code",{children:t.firstClientStructure.name})]}),t.firstClientStructure.phone&&(0,i.jsxs)("li",{children:["Телефон: ",i.jsx("code",{children:t.firstClientStructure.phone})]}),t.firstClientStructure.email&&(0,i.jsxs)("li",{children:["Email: ",i.jsx("code",{children:t.firstClientStructure.email})]})]})]}),t.customFields&&t.customFields.length>0&&(0,i.jsxs)("div",{style:{marginTop:12},children:[(0,i.jsxs)("strong",{children:["Всі поля клієнта (",t.allKeys?.length||0,"):"]}),i.jsx("div",{style:{marginTop:8,padding:8,background:"#fff",borderRadius:4,fontSize:"0.85em",maxHeight:"200px",overflowY:"auto"},children:i.jsx("code",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all"},children:JSON.stringify(t.firstClientStructure.customFieldsData,null,2)})})]}),t.firstClientStructure.custom_fields&&(0,i.jsxs)("div",{style:{marginTop:12},children:[i.jsx("strong",{children:"Custom fields об'єкт:"}),i.jsx("div",{style:{marginTop:8,padding:8,background:"#fff",borderRadius:4,fontSize:"0.85em",maxHeight:"150px",overflowY:"auto"},children:i.jsx("code",{style:{whiteSpace:"pre-wrap",wordBreak:"break-all"},children:JSON.stringify(t.firstClientStructure.custom_fields,null,2)})})]}),t.firstClientStructure.rawStructure&&i.jsx("div",{style:{marginTop:12},children:(0,i.jsxs)("details",{children:[i.jsx("summary",{style:{cursor:"pointer",fontWeight:600,marginBottom:8},children:"\uD83D\uDD0D Повна raw структура першого клієнта (для діагностики)"}),i.jsx("div",{style:{marginTop:8,padding:8,background:"#fff",borderRadius:4,fontSize:"0.8em",maxHeight:"400px",overflowY:"auto",border:"1px solid #e0e7ef"},children:i.jsx("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-all"},children:t.firstClientStructure.rawStructure})})]})})]}),t.error&&(0,i.jsxs)("div",{style:{marginTop:8,fontSize:"0.9em",opacity:.9},children:[t.error,(t.error.includes("No company management rights")||t.error.includes("403"))&&(0,i.jsxs)("div",{style:{marginTop:12,padding:12,background:"#fff3cd",borderRadius:6,border:"1px solid #ffc107",color:"#856404"},children:[i.jsx("strong",{children:"\uD83D\uDCA1 Важливо! Після надання прав потрібно згенерувати новий USER_TOKEN:"}),(0,i.jsxs)("ol",{style:{margin:"8px 0 0 0",paddingLeft:22},children:[i.jsx("li",{children:"Перейдіть в кабінет Altegio → Маркетплейс → Ваш додаток"}),i.jsx("li",{children:'Відкрийте розділ "Доступ до API" (API Access)'}),(0,i.jsxs)("li",{children:["Переконайтеся, що права надані:",(0,i.jsxs)("ul",{style:{marginTop:4,paddingLeft:18},children:[i.jsx("li",{children:'✅ "Клієнтська база" (Client base) - всі права'}),i.jsx("li",{children:'✅ "Журнал запису" (Record log) - всі права'})]})]}),(0,i.jsxs)("li",{children:[i.jsx("strong",{children:"ВАЖЛИВО:"})," Після надання прав ",i.jsx("strong",{children:"необхідно згенерувати новий USER_TOKEN"}),":",(0,i.jsxs)("ul",{style:{marginTop:4,paddingLeft:18},children:[i.jsx("li",{children:'Скопіюйте новий токен з поля "User Token"'}),(0,i.jsxs)("li",{children:["Оновіть змінну середовища ",i.jsx("code",{children:"ALTEGIO_USER_TOKEN"})," в Vercel"]}),i.jsx("li",{children:"Старий токен може не мати нових прав, навіть якщо права надані!"})]})]}),i.jsx("li",{children:"Після оновлення токена зачекайте 1-2 хвилини або перезапустіть деплой"})]}),(0,i.jsxs)("p",{style:{margin:"12px 0 0 0",padding:8,background:"#ffe69c",borderRadius:4,fontSize:"0.9em"},children:["⚠️ ",i.jsx("strong",{children:"Поточна помилка:"})," Навіть якщо права надані, старий USER_TOKEN не має цих прав. Потрібно згенерувати новий токен!"]})]})]})]}),z&&(0,i.jsxs)("div",{style:{marginTop:24,padding:16,background:"#f0f9ff",borderRadius:8,border:"1px solid #bae6fd"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[(0,i.jsxs)("h3",{style:{margin:0,display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{style:{fontSize:"1.2em"},children:"\uD83D\uDD0D"})," Повна структура клієнта ",z.clientId]}),i.jsx("button",{onClick:()=>W(null),style:{padding:"6px 12px",background:"#6b7280",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontSize:"0.85em"},children:"✕ Закрити"})]}),z.ok&&z.rawStructure&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{marginBottom:12,padding:12,background:"#fff",borderRadius:6,border:"1px solid #e0e7ef"},children:[i.jsx("strong",{style:{display:"block",marginBottom:8},children:"\uD83D\uDCCB Повна raw структура:"}),i.jsx("pre",{style:{margin:0,padding:12,background:"#f8fafc",borderRadius:4,fontSize:"0.85em",maxHeight:"500px",overflow:"auto",whiteSpace:"pre-wrap",wordBreak:"break-all"},children:z.rawStructure})]}),z.customFieldsData&&(0,i.jsxs)("div",{style:{marginBottom:12,padding:12,background:"#dcfce7",borderRadius:6,border:"1px solid #86efac"},children:[i.jsx("strong",{style:{display:"block",marginBottom:8,color:"#166534"},children:"✅ Custom Fields:"}),i.jsx("pre",{style:{margin:0,padding:12,background:"#fff",borderRadius:4,fontSize:"0.85em",maxHeight:"300px",overflow:"auto",whiteSpace:"pre-wrap"},children:JSON.stringify(z.customFieldsData,null,2)})]}),z.client?._meta&&(0,i.jsxs)("div",{style:{marginTop:12,padding:12,background:"#fff",borderRadius:6,border:"1px solid #e0e7ef"},children:[i.jsx("strong",{style:{display:"block",marginBottom:8},children:"\uD83D\uDCCA Мета-інформація:"}),(0,i.jsxs)("ul",{style:{margin:0,paddingLeft:20,fontSize:"0.9em"},children:[(0,i.jsxs)("li",{children:["Всього полів: ",z.client._meta.allKeys?.length||0]}),(0,i.jsxs)("li",{children:["Кастомні поля: ",z.client._meta.customFields?.length||0]}),(0,i.jsxs)("li",{children:["Має custom_fields: ",z.client._meta.hasCustomFields?"✅ Так":"❌ Ні"]}),z.client._meta.customFieldsKeys&&z.client._meta.customFieldsKeys.length>0&&(0,i.jsxs)("li",{children:["Ключі custom_fields: ",z.client._meta.customFieldsKeys.join(", ")]})]})]})]}),!z.ok&&z.error&&(0,i.jsxs)("div",{style:{padding:12,background:"#fef2f2",borderRadius:6,border:"1px solid #fca5a5",color:"#991b1b"},children:[i.jsx("strong",{children:"❌ Помилка:"})," ",z.error]})]})]}),T&&i.jsx(l,{title:"\uD83D\uDD27 Діагностика API клієнтів",emoji:"\uD83D\uDD27",children:(0,i.jsxs)("div",{style:{padding:16},children:[T.ok&&T.results&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{marginBottom:16,padding:12,background:"#f0f9ff",borderRadius:6,border:"1px solid #bae6fd"},children:[i.jsx("strong",{children:"\uD83D\uDCCA Підсумок тестування:"}),(0,i.jsxs)("ul",{style:{margin:"8px 0 0 0",paddingLeft:22},children:[(0,i.jsxs)("li",{children:["Всього тестів: ",i.jsx("strong",{children:T.summary?.totalTests||0})]}),(0,i.jsxs)("li",{children:["Успішних: ",i.jsx("strong",{style:{color:"#16a34a"},children:T.summary?.successful||0})]}),(0,i.jsxs)("li",{children:["Помилок: ",i.jsx("strong",{style:{color:"#dc2626"},children:T.summary?.failed||0})]}),(0,i.jsxs)("li",{children:["Винятків: ",i.jsx("strong",{style:{color:"#dc2626"},children:T.summary?.errors||0})]})]})]}),(0,i.jsxs)("div",{style:{marginTop:16},children:[i.jsx("strong",{children:"Детальні результати:"}),i.jsx("div",{style:{marginTop:12},children:T.results.map((e,r)=>(0,i.jsxs)("div",{style:{marginBottom:12,padding:12,background:e.success?"#f0fdf4":e.error?"#fef2f2":"#fef3c7",borderRadius:6,border:`1px solid ${e.success?"#86efac":e.error?"#fca5a5":"#fcd34d"}`},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,i.jsxs)("strong",{style:{color:e.success?"#166534":e.error?"#991b1b":"#92400e"},children:[e.success?"✅":e.error?"❌":"⚠️"," ",e.test]}),e.status&&(0,i.jsxs)("span",{style:{fontSize:"0.9em",color:e.success?"#16a34a":"#dc2626"},children:[e.status," ",e.statusText]})]}),e.url&&(0,i.jsxs)("div",{style:{marginTop:8,fontSize:"0.85em",color:"#6b7280"},children:[i.jsx("strong",{children:"URL:"})," ",i.jsx("code",{style:{wordBreak:"break-all"},children:e.url})]}),e.method&&(0,i.jsxs)("div",{style:{marginTop:4,fontSize:"0.85em",color:"#6b7280"},children:[i.jsx("strong",{children:"Method:"})," ",i.jsx("code",{children:e.method})]}),e.response&&(0,i.jsxs)("details",{style:{marginTop:8,cursor:"pointer"},children:[i.jsx("summary",{style:{fontWeight:600,fontSize:"0.9em"},children:"Відповідь API"}),i.jsx("div",{style:{marginTop:8,padding:8,background:"#fff",borderRadius:4,fontSize:"0.85em",maxHeight:"300px",overflowY:"auto"},children:i.jsx("pre",{style:{margin:0,whiteSpace:"pre-wrap",wordBreak:"break-all"},children:JSON.stringify(e.response,null,2)})})]}),e.error&&(0,i.jsxs)("div",{style:{marginTop:8,padding:8,background:"#fee2e2",borderRadius:4,color:"#991b1b",fontSize:"0.85em"},children:[i.jsx("strong",{children:"Помилка:"})," ",e.error]})]},r))})]})]}),!T.ok&&T.error&&(0,i.jsxs)("div",{style:{padding:12,background:"#fef2f2",borderRadius:6,border:"1px solid #fca5a5",color:"#991b1b"},children:[i.jsx("strong",{children:"❌ Помилка:"})," ",T.error]})]})}),(0,i.jsxs)(l,{title:"Календар записів",emoji:"\uD83D\uDCC5",children:[(0,i.jsxs)("div",{style:{marginBottom:16},children:[i.jsx("p",{style:{marginBottom:12},children:"Отримання майбутніх записів з календаря (на наступні 30 днів). Перевірка наявності Instagram username у клієнтів."}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx("button",{onClick:q,disabled:a.loading,style:{padding:"10px 20px",background:"#2a6df5",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:a.loading?"not-allowed":"pointer",opacity:a.loading?.6:1},children:a.loading?"Завантаження...":"Отримати майбутні записи"}),i.jsx("button",{onClick:X,disabled:c.loading,style:{padding:"10px 20px",background:"#f59e0b",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:c.loading?"not-allowed":"pointer",opacity:c.loading?.6:1},children:c.loading?"Завантаження...":"\uD83D\uDCCA Отримати записи за тиждень (всі поля)"})]})]}),null!==a.ok&&(0,i.jsxs)("div",{style:{padding:12,borderRadius:8,background:a.ok?"#f0fdf4":"#fef2f2",border:`1px solid ${a.ok?"#86efac":"#fca5a5"}`,color:a.ok?"#166534":"#991b1b"},children:[(0,i.jsxs)("strong",{children:[a.ok?"✅ Успішно":"❌ Помилка",":"]})," ",a.message,a.ok&&void 0!==a.appointmentsCount&&(0,i.jsxs)("div",{style:{marginTop:12,padding:12,background:"#f0f9ff",borderRadius:6,border:"1px solid #bae6fd",color:"#0c4a6e"},children:[i.jsx("div",{style:{marginBottom:8},children:i.jsx("strong",{children:"\uD83D\uDCCA Статистика:"})}),(0,i.jsxs)("ul",{style:{margin:"8px 0",paddingLeft:22},children:[(0,i.jsxs)("li",{children:["Всього майбутніх записів: ",i.jsx("strong",{children:a.appointmentsCount})]}),(0,i.jsxs)("li",{children:["Записів з Instagram username: ",i.jsx("strong",{children:a.appointmentsWithInstagram||0})]}),(0,i.jsxs)("li",{children:["Період: ",(0,i.jsxs)("strong",{children:["наступні ",a.days||30," днів"]})]})]})]}),a.ok&&a.appointments&&a.appointments.length>0&&(0,i.jsxs)("div",{style:{marginTop:16},children:[(0,i.jsxs)("strong",{style:{display:"block",marginBottom:12},children:["\uD83D\uDCCB Список записів (",a.appointments.slice(0,10).length," з ",a.appointments.length,"):"]}),(0,i.jsxs)("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid #e5e7eb",borderRadius:6,padding:8},children:[a.appointments.slice(0,10).map((e,r)=>(0,i.jsxs)("div",{style:{padding:10,marginBottom:8,background:"#fff",borderRadius:6,border:"1px solid #e5e7eb",fontSize:"0.9em"},children:[(0,i.jsxs)("div",{style:{fontWeight:600,marginBottom:4},children:[e.client_name||"Без імені",e.instagram_username&&(0,i.jsxs)("span",{style:{marginLeft:8,color:"#22c55e",fontSize:"0.85em"},children:["\uD83D\uDCF1 @",e.instagram_username]})]}),(0,i.jsxs)("div",{style:{color:"#6b7280",fontSize:"0.85em"},children:[e.datetime?new Date(e.datetime).toLocaleString("uk-UA",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Дата не вказана",e.status&&(0,i.jsxs)("span",{style:{marginLeft:8},children:["• Статус: ",e.status]})]})]},e.id||r)),a.appointments.length>10&&(0,i.jsxs)("div",{style:{textAlign:"center",padding:8,color:"#6b7280",fontSize:"0.85em"},children:["... та ще ",a.appointments.length-10," записів"]})]})]}),a.error&&(0,i.jsxs)("div",{style:{marginTop:8,fontSize:"0.9em",opacity:.9},children:[a.error,a.error.includes("No company management rights")&&(0,i.jsxs)("div",{style:{marginTop:12,padding:12,background:"#fff3cd",borderRadius:6,border:"1px solid #ffc107",color:"#856404"},children:[i.jsx("strong",{children:'\uD83D\uDCA1 Як вирішити помилку "No company management rights":'}),(0,i.jsxs)("ol",{style:{margin:"8px 0 0 0",paddingLeft:22},children:[i.jsx("li",{children:"Перейдіть в кабінет Altegio → Маркетплейс → Ваш додаток"}),i.jsx("li",{children:'Відкрийте розділ "Доступ до API" (API Access)'}),(0,i.jsxs)("li",{children:["Переконайтеся, що у вашому USER_TOKEN включені права:",(0,i.jsxs)("ul",{style:{marginTop:4,paddingLeft:18},children:[i.jsx("li",{children:"✅ Читання клієнтів (Read clients)"}),i.jsx("li",{children:"✅ Читання записів (Read appointments)"}),i.jsx("li",{children:"✅ Управління компанією (Company management)"})]})]}),i.jsx("li",{children:"Якщо права не налаштовані, оновіть токен або створіть новий з необхідними правами"}),i.jsx("li",{children:"Після оновлення прав оновіть ALTEGIO_USER_TOKEN в Vercel environment variables"})]})]})]})]}),null!==c.ok&&(0,i.jsxs)("div",{style:{marginTop:16,padding:12,borderRadius:8,background:c.ok?"#f0fdf4":"#fef2f2",border:`1px solid ${c.ok?"#86efac":"#fca5a5"}`,color:c.ok?"#166534":"#991b1b"},children:[(0,i.jsxs)("strong",{children:[c.ok?"✅ Успішно (записи за тиждень)":"❌ Помилка (записи за тиждень)",":"]})," ",c.data?.message||c.error,c.ok&&c.data&&(0,i.jsxs)("div",{style:{marginTop:12,padding:12,background:"#f0f9ff",borderRadius:6,border:"1px solid #bae6fd",color:"#0c4a6e"},children:[i.jsx("div",{style:{marginBottom:8},children:i.jsx("strong",{children:"\uD83D\uDCCA Статистика за тиждень:"})}),(0,i.jsxs)("ul",{style:{margin:"8px 0",paddingLeft:22,fontSize:"0.9em"},children:[(0,i.jsxs)("li",{children:["Всього записів (appointments + visits):"," ",i.jsx("strong",{children:c.data.summary?.total??c.data.totalAppointments??"—"})]}),(0,i.jsxs)("li",{children:["Минулі записи:"," ",i.jsx("strong",{children:c.data.summary?.past??c.data.pastAppointmentsCount??"—"})]}),(0,i.jsxs)("li",{children:["Майбутні записи:"," ",i.jsx("strong",{children:c.data.summary?.future??c.data.upcomingAppointmentsCount??"—"})]})]})]})]})]}),(0,i.jsxs)(l,{title:"Шаблони повідомлень",emoji:"✏️",children:[(0,i.jsxs)("div",{style:{marginBottom:16},children:[(0,i.jsxs)("p",{style:{marginBottom:12},children:["Налаштуйте шаблони повідомлень для нагадувань. Використовуйте плейсхолдери: ","{date}",", ","{time}",", ","{clientName}",", ","{daysLeft}",", ","{service}",", ","{master}","."]}),i.jsx("button",{onClick:er,disabled:y.loading,style:{padding:"10px 20px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:y.loading?"not-allowed":"pointer",opacity:y.loading?.6:1,marginBottom:12},children:y.loading?"Завантаження...":"Завантажити шаблони"})]}),null!==y.ok&&i.jsx("div",{children:y.ok&&y.rules?(0,i.jsxs)("div",{children:[y.rules.map((e,r)=>(0,i.jsxs)("div",{style:{marginBottom:20,padding:16,background:"#f8fafc",borderRadius:8,border:"1px solid #e2e8f0"},children:[(0,i.jsxs)("div",{style:{marginBottom:12,display:"flex",alignItems:"center",gap:12},children:[(0,i.jsxs)("strong",{style:{fontSize:"1.1em"},children:["За ",e.daysBefore," ",1===e.daysBefore?"день":e.daysBefore<5?"дні":"днів"," до візиту"]}),(0,i.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:6,marginLeft:"auto"},children:[i.jsx("input",{type:"checkbox",checked:e.active,onChange:e=>{let t=[...y.rules];t[r].active=e.target.checked,b({...y,rules:t})},style:{width:18,height:18}}),i.jsx("span",{style:{fontSize:"0.9em"},children:"Активне"})]})]}),i.jsx("textarea",{value:e.template,onChange:e=>{let t=[...y.rules];t[r].template=e.target.value,b({...y,rules:t})},style:{width:"100%",minHeight:80,padding:12,border:"1px solid #cbd5e1",borderRadius:6,fontSize:"0.95em",fontFamily:"inherit",resize:"vertical"},placeholder:"Введіть шаблон повідомлення..."}),(0,i.jsxs)("div",{style:{marginTop:8,fontSize:"0.85em",color:"#64748b"},children:["Доступні плейсхолдери: ","{date}",", ","{time}",", ","{clientName}",", ","{daysLeft}",", ","{service}",", ","{master}",", ","{instagram}"]})]},e.id)),i.jsx("button",{onClick:et,disabled:y.loading,style:{padding:"12px 24px",background:"#22c55e",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:y.loading?"not-allowed":"pointer",opacity:y.loading?.6:1,fontSize:"1em"},children:y.loading?"Збереження...":"\uD83D\uDCBE Зберегти шаблони"})]}):(0,i.jsxs)("div",{children:[i.jsx("strong",{children:"❌ Помилка:"})," ",y.error||"Не вдалося завантажити шаблони"]})})]}),(0,i.jsxs)(l,{title:"Черга нагадувань",emoji:"\uD83D\uDCEC",children:[(0,i.jsxs)("div",{style:{marginBottom:16},children:[i.jsx("p",{style:{marginBottom:12},children:"Клієнти, які очікують на відправку нагадувань про майбутні візити. Нагадування створюються автоматично при створенні/оновленні записів у Altegio."}),(0,i.jsxs)("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx("button",{onClick:()=>Q("pending"),disabled:p.loading,style:{padding:"10px 20px",background:"#2a6df5",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:p.loading?"not-allowed":"pointer",opacity:p.loading?.6:1},children:p.loading?"Завантаження...":"Оновити чергу"}),i.jsx("button",{onClick:()=>Q("all"),disabled:p.loading,style:{padding:"10px 20px",background:"#6b7280",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:p.loading?"not-allowed":"pointer",opacity:p.loading?.6:1},children:p.loading?"Завантаження...":"Всі job'и"}),i.jsx("button",{onClick:Z,disabled:m.loading,style:{padding:"10px 20px",background:"#f59e0b",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:m.loading?"not-allowed":"pointer",opacity:m.loading?.6:1},children:m.loading?"Завантаження...":"\uD83D\uDD0D Діагностика"}),i.jsx("button",{onClick:async()=>{let e=new Date;e.setDate(e.getDate()+7),e.setHours(15,0,0,0);try{let r=await fetch("/api/altegio/reminders/test-create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitId:999999999,datetime:e.toISOString(),instagram:"mykolayyurashko",clientName:"Микола Юрашко (тест)"})}),t=await r.json();t.ok?(alert(`✅ Створено ${t.jobsCreated.length} job'ів! Тепер оновіть чергу.`),Q()):alert(`❌ Помилка: ${t.error}`)}catch(e){alert(`❌ Помилка: ${e instanceof Error?e.message:"Невідома помилка"}`)}},style:{padding:"10px 20px",background:"#10b981",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer"},children:"\uD83E\uDDEA Тест створення job'ів"}),i.jsx("button",{onClick:async()=>{if(p.jobs&&p.jobs.length>0){let e=p.jobs[0];if(!confirm(`Відправити тестове повідомлення для:

Клієнт: ${e.clientName}
Instagram: ${e.instagram||"—"}
Дата візиту: ${new Date(e.visitDateTime).toLocaleString("uk-UA")}

Продовжити?`))return;let r=prompt(`Відправити тестове повідомлення для:

Клієнт: ${e.clientName}
Instagram: ${e.instagram||"—"}
Дата візиту: ${new Date(e.visitDateTime).toLocaleString("uk-UA")}

Якщо знаєш Subscriber ID з ManyChat Dashboard, введи його (або залиш порожнім для автоматичного пошуку):`);if(null!==r)try{let t=await fetch("/api/altegio/reminders/test-send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jobId:e.id,subscriberId:r?.trim()||void 0})}),i=await t.json();if(i.ok){let e=i.method?.includes("симуляція")?`⚠️ ${i.method}

💡 Для реальної відправки:
1. Додай MANYCHAT_API_KEY в Vercel
2. Переконайся, що @${i.job.instagram} взаємодіяв з ManyChat ботом`:`✅ ${i.method}`;alert(`${i.method?.includes("симуляція")?"⚠️":"✅"} Повідомлення відправлено!

Метод: ${e}
Instagram: ${i.job.instagram}
Message ID: ${i.result.messageId||"—"}

`+(i.diagnostics?`Діагностика:
- ManyChat API: ${i.diagnostics.manychatApiKeyConfigured?"✅ Налаштовано":"❌ Не налаштовано"}
- Instagram API: ${i.diagnostics.instagramTokenConfigured?"✅ Налаштовано":"❌ Не налаштовано"}`:"")),ee()}else alert(`❌ Помилка відправки:
${i.error||"Невідома помилка"}`)}catch(e){alert(`❌ Помилка: ${e instanceof Error?e.message:"Невідома помилка"}`)}}else{if(!confirm(`Відправити тестове повідомлення для тестового клієнта @mykolayyurashko?

(Якщо ManyChat API не налаштовано, буде симуляція)`))return;try{let e=await fetch("/api/altegio/reminders/test-send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({instagram:"mykolayyurashko"})}),r=await e.json();if(r.ok){let e=r.method?.includes("симуляція")?`⚠️ ${r.method}

💡 Для реальної відправки:
1. Додай MANYCHAT_API_KEY в Vercel
2. Переконайся, що @${r.job.instagram} взаємодіяв з ManyChat ботом`:`✅ ${r.method}`;alert(`${r.method?.includes("симуляція")?"⚠️":"✅"} Повідомлення відправлено!

Метод: ${e}
Instagram: ${r.job.instagram}
Message ID: ${r.result.messageId||"—"}

`+(r.diagnostics?`Діагностика:
- ManyChat API: ${r.diagnostics.manychatApiKeyConfigured?"✅ Налаштовано":"❌ Не налаштовано"}
- Instagram API: ${r.diagnostics.instagramTokenConfigured?"✅ Налаштовано":"❌ Не налаштовано"}`:"")),ee()}else alert(`❌ Помилка відправки:
${r.error||"Невідома помилка"}`)}catch(e){alert(`❌ Помилка: ${e instanceof Error?e.message:"Невідома помилка"}`)}}},style:{padding:"10px 20px",background:"#8b5cf6",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer"},children:"\uD83D\uDCE4 Тест відправки"}),i.jsx("button",{onClick:async()=>{try{let e=await fetch("/api/altegio/reminders/check-subscriber?instagram=mykolayyurashko",{method:"GET"}),r=await e.json();if(r.ok){let e=r.instagram.startsWith("@")?r.instagram:`@${r.instagram}`;r.found?alert(`✅ Subscriber знайдено в ManyChat!

Instagram: ${e}
Subscriber ID: ${r.subscriberId}

Тепер можна відправляти повідомлення.`):alert(`❌ Subscriber не знайдено в ManyChat

Instagram: ${e}

Що робити:
1. Відкрий Instagram на акаунті ${e}
2. Знайди ManyChat бот (або сторінку, яка використовує ManyChat)
3. Напиши будь-яке повідомлення боту
4. Або натисни на кнопку в автоматизації ManyChat
5. Після цього спробуй перевірити знову`)}else alert(`❌ Помилка перевірки:
${r.error||"Невідома помилка"}

${r.diagnostics?`Перевірені змінні: ${r.diagnostics.checkedVariables?.join(", ")}`:""}`)}catch(e){alert(`❌ Помилка: ${e instanceof Error?e.message:"Невідома помилка"}`)}},style:{padding:"10px 20px",background:"#06b6d4",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer"},children:"\uD83D\uDD0D Перевірити subscriber"}),i.jsx("button",{onClick:async()=>{try{let e=await fetch("/api/altegio/reminders/test-manychat-api?instagram=mykolayyurashko",{method:"GET"}),r=await e.json();if(r.ok){let e=r.successfulResults||[],t=r.allResults||[],i=`🔍 Діагностика ManyChat API

`;i+=`Instagram: ${r.instagram}
Знайдено: ${r.found?"✅ Так":"❌ Ні"}

Успішні тести: ${e.length}
Всього тестів: ${t.length}

`,e.length>0?(i+=`✅ Знайдено через:
`,e.forEach(e=>{i+=`- ${e.method}: Subscriber ID ${e.subscriberId}
`})):(i+=`❌ Не знайдено жодним методом:

`,t.forEach(e=>{if(i+=`${e.method}:
  Status: ${e.status||"N/A"}
`,e.error)i+=`  Error: ${e.error}
`;else if(e.response){let r="string"==typeof e.response?e.response:JSON.stringify(e.response).substring(0,200);i+=`  Response: ${r}
`}i+=`
`}),r.recommendations&&r.recommendations.length>0&&(i+=`
💡 Рекомендації:
`,r.recommendations.forEach(e=>{i+=`${e}
`}))),$({open:!0,title:"\uD83D\uDD2C Діагностика ManyChat API",content:i,jsonData:r})}else $({open:!0,title:"❌ Помилка",content:`Помилка: ${r.error||"Невідома помилка"}`,jsonData:r})}catch(e){$({open:!0,title:"❌ Помилка",content:`Помилка: ${e instanceof Error?e.message:"Невідома помилка"}`})}},style:{padding:"10px 20px",background:"#f59e0b",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer"},children:"\uD83D\uDD2C Діагностика ManyChat API"}),i.jsx("button",{onClick:async()=>{try{let e=await fetch("/api/altegio/reminders/test-manychat-detailed?instagram=mykolayyurashko",{method:"GET"}),r=await e.json();if(r.ok){let e=r.successfulResults||[],t=r.allResults||[],i=`🔍 ДЕТАЛЬНА ДІАГНОСТИКА ManyChat API

`;i+=`Instagram: ${r.instagram}
API Key: ${r.apiKeyInfo?.length||"N/A"} символів
Знайдено: ${r.found?"✅ Так":"❌ Ні"}

Успішні тести: ${e.length}
Всього тестів: ${t.length}

`,e.length>0?(i+=`✅ Знайдено через:
`,e.forEach(e=>{i+=`- ${e.method}: Subscriber ID ${e.subscriberId}
`})):(i+=`❌ Не знайдено жодним методом

Детальні результати:
`,t.forEach(e=>{i+=`
${e.method}:
  Status: ${e.status||"N/A"} ${e.statusText||""}
`,e.error?i+=`  Error: ${e.error}
`:e.response&&(e.response.parsed?i+=`  Response: ${JSON.stringify(e.response.parsed).substring(0,300)}...
`:i+=`  Response: ${e.response.raw?.substring(0,300)||"N/A"}...
`)}),r.recommendations&&r.recommendations.length>0&&(i+=`

💡 Рекомендації:
`,r.recommendations.forEach(e=>{i+=`${e}
`}))),console.log("[ManyChat Detailed Test]",r),$({open:!0,title:"\uD83D\uDD0D ДЕТАЛЬНА ДІАГНОСТИКА ManyChat API",content:i,jsonData:r})}else alert(`❌ Помилка: ${r.error||"Невідома помилка"}`)}catch(e){alert(`❌ Помилка: ${e instanceof Error?e.message:"Невідома помилка"}`)}},style:{padding:"10px 20px",background:"#8b5cf6",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer"},children:"\uD83D\uDD2C Детальна діагностика ManyChat API"}),i.jsx("button",{onClick:async()=>{try{let e=await fetch("/api/altegio/reminders/fix-index",{method:"POST"}),r=await e.json();r.ok?(alert(`✅ ${r.message}
${r.oldType?`Старий тип: ${r.oldType}`:""}
${r.count?`Кількість: ${r.count}`:""}`),Q(),Z()):alert(`❌ Помилка: ${r.error}`)}catch(e){alert(`❌ Помилка: ${e instanceof Error?e.message:"Невідома помилка"}`)}},style:{padding:"10px 20px",background:"#ef4444",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer"},children:"\uD83D\uDD27 Виправити індекс"}),i.jsx("button",{onClick:async()=>{try{let e=await fetch("/api/altegio/reminders/check-webhook",{method:"GET"}),r=await e.json();if(r.ok){let e=r.lastRecordEvents||[];if(0===e.length)alert("❌ Немає останніх подій по записах. Перевір, чи налаштований webhook в Altegio.");else{let r=e[0],t=`Знайдено ${e.length} останніх подій по записах.

Остання подія:
- Дата: ${new Date(r.receivedAt).toLocaleString("uk-UA")}
- Статус: ${r.status}
- Visit ID: ${r.visitId}
- Дата візиту: ${r.datetime||"—"}
- Клієнт: ${r.clientName||"—"}
- Instagram: ${r.instagram?"@"+r.instagram:"—"}

${"mykolayyurashko"===r.instagram?"✅ Це тестовий клієнт!":"❌ Це не тестовий клієнт"}`;if("mykolayyurashko"===r.instagram&&r.datetime){if(confirm(t+"\n\nСтворити job'и для цього запису?"))try{let e=await fetch("/api/altegio/reminders/check-webhook",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({visitId:r.visitId,datetime:r.datetime,instagram:r.instagram,clientName:r.clientName,companyId:1169323,clientId:r.clientId})}),t=await e.json();t.ok?(alert(`✅ Створено ${t.jobsCreated.length} job'ів! Тепер оновіть чергу.`),Q()):alert(`❌ Помилка створення job'ів: ${t.error}`)}catch(e){alert(`❌ Помилка: ${e instanceof Error?e.message:"Невідома помилка"}`)}}else alert(t)}}else alert(`❌ Помилка: ${r.error}`)}catch(e){alert(`❌ Помилка: ${e instanceof Error?e.message:"Невідома помилка"}`)}},style:{padding:"10px 20px",background:"#8b5cf6",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:"pointer"},children:"\uD83D\uDD0D Перевірити webhook"})]})]}),null!==p.ok&&i.jsx("div",{style:{padding:12,borderRadius:8,background:p.ok?"#f0fdf4":"#fef2f2",border:`1px solid ${p.ok?"#86efac":"#fca5a5"}`,color:p.ok?"#166534":"#991b1b"},children:p.ok&&void 0!==p.jobs?(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{marginBottom:12,fontWeight:600},children:["Знайдено нагадувань: ",i.jsx("strong",{children:p.jobs.length}),p.debug&&(0,i.jsxs)("div",{style:{fontSize:"0.85em",color:"#6b7280",marginTop:4,fontWeight:400},children:["(В індексі: ",p.debug.indexTotal,", Після фільтру: ",p.debug.jobsAfterFilter,")"]})]}),0===p.jobs.length?i.jsx("p",{style:{margin:0,color:"#6b7280"},children:"Черга порожня. Нагадування будуть створюватися автоматично при створенні/оновленні записів у Altegio."}):i.jsx("div",{style:{maxHeight:"500px",overflowY:"auto",border:"1px solid #e5e7eb",borderRadius:6,padding:8},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9em"},children:[i.jsx("thead",{children:(0,i.jsxs)("tr",{style:{borderBottom:"2px solid #bae6fd",textAlign:"left"},children:[i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Клієнт"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Instagram"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Дата візиту"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Відправка"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Днів до візиту"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Дії"})]})}),i.jsx("tbody",{children:p.jobs.map((e,r)=>(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #e0e7ef",backgroundColor:r%2==0?"#fff":"#fafafa"},children:[i.jsx("td",{style:{padding:"8px",fontWeight:500},children:e.clientName||"—"}),i.jsx("td",{style:{padding:"8px",fontFamily:"monospace",fontSize:"0.85em"},children:e.instagram?(0,i.jsxs)("span",{style:{color:"#22c55e",fontWeight:600},children:["@",e.instagram]}):i.jsx("span",{style:{color:"#ef4444"},children:"—"})}),i.jsx("td",{style:{padding:"8px",fontSize:"0.85em"},children:new Date(e.visitDateTime).toLocaleString("uk-UA",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}),i.jsx("td",{style:{padding:"8px",fontSize:"0.85em",color:"#6b7280"},children:e.dueAtFormatted}),i.jsx("td",{style:{padding:"8px",fontSize:"0.85em",fontWeight:600},children:e.daysUntilVisit>0?(0,i.jsxs)("span",{style:{color:"#f59e0b"},children:[e.daysUntilVisit," дн."]}):i.jsx("span",{style:{color:"#ef4444"},children:"Сьогодні"})}),i.jsx("td",{style:{padding:"8px"},children:e.instagram?i.jsx("button",{onClick:async()=>{if(confirm(`Відправити тестове повідомлення для @${e.instagram}?`))try{let r=await fetch("/api/altegio/reminders/test-send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jobId:e.id})}),t=await r.json();if(t.ok){let e=t.method?.includes("симуляція")?`⚠️ ${t.method}

💡 Для реальної відправки:
1. Додай MANYCHAT_API_KEY в Vercel
2. Переконайся, що @${t.job.instagram} взаємодіяв з ManyChat ботом`:`✅ ${t.method}`;alert(`${t.method?.includes("симуляція")?"⚠️":"✅"} Повідомлення відправлено!

Метод: ${e}
Instagram: ${t.job.instagram}
Message ID: ${t.result?.messageId||"—"}

`+(t.diagnostics?`Діагностика:
- ManyChat API: ${t.diagnostics.manychatApiKeyConfigured?"✅ Налаштовано":"❌ Не налаштовано"}
- Instagram API: ${t.diagnostics.instagramTokenConfigured?"✅ Налаштовано":"❌ Не налаштовано"}`:"")+(t.result?.error?`

Помилка: ${t.result.error}`:"")),ee()}else alert(`❌ Помилка: ${t.error}`)}catch(e){alert(`❌ Помилка: ${e instanceof Error?e.message:"Невідома помилка"}`)}},style:{padding:"6px 12px",background:"#8b5cf6",color:"#fff",border:"none",borderRadius:6,fontSize:"0.85em",fontWeight:600,cursor:"pointer"},children:"\uD83D\uDCE4 Тест"}):i.jsx("span",{style:{color:"#9ca3af",fontSize:"0.85em"},children:"—"})})]},e.id))})]})})]}):(0,i.jsxs)("div",{children:[i.jsx("strong",{children:"❌ Помилка:"})," ",p.error||"Не вдалося завантажити чергу"]})}),null!==m.ok&&(0,i.jsxs)("div",{style:{marginTop:16,padding:12,background:m.ok?"#f0f9ff":"#fef2f2",borderRadius:8,border:`1px solid ${m.ok?"#bae6fd":"#fca5a5"}`},children:[i.jsx("strong",{style:{display:"block",marginBottom:12},children:"\uD83D\uDD0D Діагностика нагадувань:"}),(0,i.jsxs)("div",{style:{marginBottom:12},children:[i.jsx("strong",{children:"Webhook події:"}),(0,i.jsxs)("ul",{style:{margin:"4px 0",paddingLeft:20,fontSize:"0.9em"},children:[(0,i.jsxs)("li",{children:["Всього подій: ",m.data?.webhookEvents?.total||0]}),(0,i.jsxs)("li",{children:["Подій по записах: ",m.data?.webhookEvents?.recordEvents||0]}),m.data?.webhookEvents?.eventsByResource&&m.data?.webhookEvents?.eventsByResource.length>0&&(0,i.jsxs)("li",{children:["По ресурсах:"," ",m.data?.webhookEvents?.eventsByResource.map(e=>`${e.resource}: ${e.count}`).join(", ")]})]}),m.data?.webhookEvents?.lastRecordEvents&&m.data?.webhookEvents?.lastRecordEvents.length>0&&(0,i.jsxs)("details",{style:{marginTop:8},children:[(0,i.jsxs)("summary",{style:{cursor:"pointer",fontWeight:600,fontSize:"0.9em"},children:["Останні події по записах (",m.data?.webhookEvents?.lastRecordEvents?.length||0,")"]}),i.jsx("div",{style:{marginTop:8,padding:8,background:"#fff",borderRadius:4,fontSize:"0.85em",maxHeight:"300px",overflowY:"auto"},children:m.data?.webhookEvents?.lastRecordEvents?.map((e,r)=>i.jsxs("div",{style:{marginBottom:8,padding:8,background:"#f8fafc",borderRadius:4,border:"1px solid #e0e7ef"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Дата:"})," ",new Date(e.receivedAt).toLocaleString("uk-UA")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Статус:"})," ",e.status]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Visit ID:"})," ",e.visitId]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Дата візиту:"})," ",e.datetime||"—"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Клієнт:"})," ",e.clientName||"—"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Instagram:"})," ",e.instagram?i.jsxs("span",{style:{color:"#22c55e",fontWeight:600},children:["@",e.instagram]}):i.jsx("span",{style:{color:"#ef4444"},children:"—"})]})]},r))})]}),m.data?.webhookEvents?.lastAllEvents&&m.data?.webhookEvents?.lastAllEvents.length>0&&(0,i.jsxs)("details",{style:{marginTop:8},children:[(0,i.jsxs)("summary",{style:{cursor:"pointer",fontWeight:600,fontSize:"0.9em"},children:["Всі останні webhook події (",m.data?.webhookEvents?.lastAllEvents?.length||0,")"]}),i.jsx("div",{style:{marginTop:8,padding:8,background:"#fff",borderRadius:4,fontSize:"0.85em",maxHeight:"400px",overflowY:"auto"},children:m.data?.webhookEvents?.lastAllEvents?.map((e,r)=>i.jsxs("div",{style:{marginBottom:8,padding:8,background:"record"===e.resource?"#dcfce7":"#f8fafc",borderRadius:4,border:`1px solid ${"record"===e.resource?"#86efac":"#e0e7ef"}`},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Дата:"})," ",new Date(e.receivedAt).toLocaleString("uk-UA")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Resource:"})," ",i.jsx("span",{style:{color:"record"===e.resource?"#22c55e":"#6b7280",fontWeight:"record"===e.resource?600:400},children:e.resource||"—"})]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Resource ID:"})," ",e.resource_id||"—"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Status:"})," ",e.status||"—"]}),"record"===e.resource&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Дата візиту:"})," ",e.datetime||"—"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Клієнт:"})," ",e.clientName||"—"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Instagram:"})," ",e.instagram?i.jsxs("span",{style:{color:"#22c55e",fontWeight:600},children:["@",e.instagram]}):i.jsx("span",{style:{color:"#ef4444"},children:"—"})]})]}),i.jsxs("details",{style:{marginTop:4},children:[i.jsx("summary",{style:{cursor:"pointer",fontSize:"0.8em",color:"#6b7280"},children:"Повна структура події"}),i.jsx("pre",{style:{marginTop:4,padding:4,background:"#1e293b",color:"#e2e8f0",borderRadius:2,fontSize:"0.75em",overflowX:"auto"},children:JSON.stringify(e.fullBody||e,null,2)})]})]},r))})]})]}),(0,i.jsxs)("div",{style:{marginBottom:12},children:[i.jsx("strong",{children:"Job'и нагадувань:"}),(0,i.jsxs)("ul",{style:{margin:"4px 0",paddingLeft:20,fontSize:"0.9em"},children:[(0,i.jsxs)("li",{children:["Всього: ",m.data?.jobs?.total||0]}),(0,i.jsxs)("li",{children:["Pending: ",m.data?.jobs?.pending||0]}),(0,i.jsxs)("li",{children:["Sent: ",m.data?.jobs?.sent||0]}),(0,i.jsxs)("li",{children:["Failed: ",m.data?.jobs?.failed||0]}),(0,i.jsxs)("li",{children:["Canceled: ",m.data?.jobs?.canceled||0]})]}),m.data?.jobs?.byVisit&&m.data?.jobs?.byVisit.length>0&&(0,i.jsxs)("details",{style:{marginTop:8},children:[(0,i.jsxs)("summary",{style:{cursor:"pointer",fontWeight:600,fontSize:"0.9em"},children:["Job'и по візитах (",m.data?.jobs?.byVisit?.length||0,")"]}),i.jsx("div",{style:{marginTop:8,padding:8,background:"#fff",borderRadius:4,fontSize:"0.85em",maxHeight:"300px",overflowY:"auto"},children:m.data?.jobs?.byVisit?.map((e,r)=>i.jsxs("div",{style:{marginBottom:8,padding:8,background:"#f8fafc",borderRadius:4,border:"1px solid #e0e7ef"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Visit ID:"})," ",e.visitId," (",e.count," job'ів)"]}),e.jobs.map((e,r)=>i.jsxs("div",{style:{marginTop:4,padding:4,background:"#fff",borderRadius:2,fontSize:"0.8em"},children:[e.ruleId," - ",e.status," - Instagram: ",e.instagram||"—"," -"," ",e.dueAtFormatted]},r))]},r))})]})]})]})]}),(0,i.jsxs)(l,{title:"Відправлені нагадування",emoji:"✅",children:[(0,i.jsxs)("div",{style:{marginBottom:16},children:[i.jsx("p",{style:{marginBottom:12},children:"Історія відправлених нагадувань клієнтам через Instagram DM. Показує останні 50 записів."}),i.jsx("button",{onClick:ee,disabled:x.loading,style:{padding:"10px 20px",background:"#22c55e",color:"#fff",border:"none",borderRadius:8,fontWeight:600,cursor:x.loading?"not-allowed":"pointer",opacity:x.loading?.6:1},children:x.loading?"Завантаження...":"Оновити історію"})]}),null!==x.ok&&i.jsx("div",{children:x.ok?(0,i.jsxs)("div",{children:[void 0!==x.total&&(0,i.jsxs)("div",{style:{marginBottom:12,padding:12,background:"#f0fdf4",borderRadius:8,border:"1px solid #86efac"},children:[(0,i.jsxs)("strong",{children:["Знайдено відправлених повідомлень: ",x.logs?.length||0]}),void 0!==x.total&&x.total>(x.logs?.length||0)&&(0,i.jsxs)("span",{style:{color:"#6b7280",marginLeft:8},children:["(Всього в системі: ",x.total,")"]})]}),x.logs&&0!==x.logs.length?i.jsx("div",{style:{maxHeight:"500px",overflowY:"auto",border:"1px solid #e5e7eb",borderRadius:6,padding:8},children:(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"0.9em"},children:[i.jsx("thead",{children:(0,i.jsxs)("tr",{style:{borderBottom:"2px solid #86efac",textAlign:"left"},children:[i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Клієнт"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Instagram"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Дата візиту"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Відправлено"}),i.jsx("th",{style:{padding:"8px",fontWeight:600},children:"Статус"})]})}),i.jsx("tbody",{children:x.logs.map((e,r)=>(0,i.jsxs)("tr",{style:{borderBottom:"1px solid #e0e7ef",backgroundColor:r%2==0?"#fff":"#fafafa"},children:[i.jsx("td",{style:{padding:"8px",fontWeight:500},children:e.clientName||"—"}),i.jsx("td",{style:{padding:"8px",fontFamily:"monospace",fontSize:"0.85em"},children:e.instagram?(0,i.jsxs)("span",{style:{color:"#22c55e",fontWeight:600},children:["@",e.instagram]}):i.jsx("span",{style:{color:"#ef4444"},children:"—"})}),i.jsx("td",{style:{padding:"8px",fontSize:"0.85em"},children:e.visitDateTimeFormatted}),i.jsx("td",{style:{padding:"8px",fontSize:"0.85em",color:"#6b7280"},children:e.timestampFormatted}),i.jsx("td",{style:{padding:"8px",fontSize:"0.85em",fontWeight:600},children:e.success?i.jsx("span",{style:{color:"#22c55e"},children:"✅ Відправлено"}):(0,i.jsxs)("span",{style:{color:"#ef4444"},children:["❌ Помилка: ",e.error||"Невідома помилка"]})})]},e.jobId))})]})}):i.jsx("p",{style:{margin:0,color:"#6b7280"},children:"Немає відправлених повідомлень. Нагадування будуть відображатися тут після відправки через cron job."})]}):(0,i.jsxs)("div",{children:[i.jsx("strong",{children:"❌ Помилка:"})," ",x.error||"Не вдалося завантажити історію"]})})]}),(0,i.jsxs)(l,{title:"\uD83D\uDCE4 Експорт помилки для підтримки",emoji:"\uD83D\uDCE4",children:[i.jsx("p",{style:{marginBottom:16},children:"Щоб зробити скріншот для підтримки Altegio, натисніть кнопку нижче. Вона покаже всі деталі помилки в одному місці."}),i.jsx("button",{onClick:async()=>{let r=null;try{let e=await fetch("/api/altegio/diagnostics",{cache:"no-store"}),t=await e.json();t.ok&&t.diagnostics&&(r=t.diagnostics)}catch(e){console.warn("Failed to get diagnostics:",e)}let i=r?.environment?.companyId||"1169323";r?.environment?.partnerTokenFull,r?.environment?.userTokenPreview,r?.environment?.applicationId,r?.environment?.partnerId;let n={timestamp:new Date().toISOString(),companyId:i,errors:{clients:t.error||"Not tested",appointments:a.error||"Not tested"},working:{companies:e.ok?"✅ Working":"❌ Not working"},attemptedEndpoints:["POST /api/v1/clients (with company_id in body)",`POST /api/v1/company/${i}/clients`,`GET /api/v1/company/${i}/appointments`],diagnostics:r},o=window.open("","_blank");o&&(o.document.write(`
                  <!DOCTYPE html>
                  <html>
                  <head>
                    <title>Altegio API Error Details for Support</title>
                    <style>
                      body {
                        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                        max-width: 800px;
                        margin: 40px auto;
                        padding: 20px;
                        background: #f5f5f5;
                      }
                      .card {
                        background: white;
                        padding: 30px;
                        border-radius: 8px;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                        margin-bottom: 20px;
                      }
                      h1 { color: #d32f2f; margin-top: 0; }
                      h2 { color: #333; border-bottom: 2px solid #ddd; padding-bottom: 10px; }
                      .error { background: #ffebee; padding: 15px; border-radius: 4px; border-left: 4px solid #d32f2f; margin: 10px 0; }
                      .success { background: #e8f5e9; padding: 15px; border-radius: 4px; border-left: 4px solid #4caf50; margin: 10px 0; }
                      pre { background: #f5f5f5; padding: 15px; border-radius: 4px; overflow-x: auto; }
                      .info { background: #e3f2fd; padding: 15px; border-radius: 4px; margin: 10px 0; }
                    </style>
                  </head>
                  <body>
                    <div class="card">
                      <h1>🚨 Altegio API Error Report</h1>
                      <p><strong>Date:</strong> ${n.timestamp}</p>
                      <p><strong>Company ID:</strong> ${n.companyId}</p>
                    </div>

                    <div class="card">
                      <h2>✅ What Works</h2>
                      <div class="success">
                        <strong>GET /api/v1/companies</strong> - Returns company information successfully
                      </div>
                    </div>

                    <div class="card">
                      <h2>❌ What Doesn't Work</h2>
                      <div class="error">
                        <strong>POST /api/v1/clients</strong><br>
                        Error: ${n.errors.clients}
                      </div>
                      <div class="error">
                        <strong>GET /api/v1/company/1169323/appointments</strong><br>
                        Error: ${n.errors.appointments}
                      </div>
                    </div>

                    <div class="card">
                      <h2>📋 Attempted Endpoints</h2>
                      <ul>
                        ${n.attemptedEndpoints.map(e=>`<li>${e}</li>`).join("")}
                      </ul>
                    </div>

                    <div class="card">
                      <h2>🔧 Request Details</h2>
                      <div class="info">
                        <strong>Authorization Header Format:</strong><br>
                        <code>${n.diagnostics?.headers?.authorization||"Bearer [PARTNER_TOKEN], User [USER_TOKEN]"}</code>
                      </div>
                      <div class="info">
                        <strong>Headers:</strong><br>
                        <pre>Accept: application/vnd.api.v2+json
Content-Type: application/json
Authorization: ${n.diagnostics?.headers?.authorization||"Bearer [PARTNER_TOKEN], User [USER_TOKEN]"}
X-Partner-ID: ${n.diagnostics?.headers?.xPartnerId||"[PARTNER_ID]"}
X-Application-ID: ${n.diagnostics?.headers?.xApplicationId||"[APPLICATION_ID]"}</pre>
                      </div>
                    </div>

                    <div class="card">
                      <h2>📝 Application Details</h2>
                      <pre>Application ID: ${n.diagnostics?.environment?.applicationId||"[APPLICATION_ID]"}
Partner ID: ${n.diagnostics?.environment?.partnerId||"[PARTNER_ID]"}
Company ID: ${n.companyId}
Application Type: Non-public</pre>
                    </div>
                    
                    ${n.diagnostics?`
                    <div class="card">
                      <h2>🔍 Full Diagnostics</h2>
                      <pre>${JSON.stringify(n.diagnostics,null,2)}</pre>
                    </div>
                    `:""}

                    <div class="card">
                      <h2>💡 Next Steps</h2>
                      <p>Please provide:</p>
                      <ol>
                        <li>Why API returns 403 even though permissions are enabled?</li>
                        <li>Correct endpoint and method for retrieving clients?</li>
                        <li>Any additional settings needed for non-public applications?</li>
                      </ol>
                    </div>
                  </body>
                  </html>
                `),o.document.close(),alert("Відкрито нове вікно з деталями. Зробіть скріншот цього вікна для підтримки!"))},style:{padding:"12px 24px",backgroundColor:"#2a6df5",color:"white",border:"none",borderRadius:8,fontSize:16,fontWeight:600,cursor:"pointer",boxShadow:"0 2px 8px rgba(42, 109, 245, 0.3)"},children:"\uD83D\uDCF8 Створити звіт для підтримки"}),i.jsx("p",{style:{marginTop:12,fontSize:"0.9em",color:"#666"},children:"Кнопка відкриє нове вікно з усіма деталями помилки. Зробіть скріншот цього вікна."})]}),i.jsx(l,{title:"Статус",emoji:"\uD83D\uDEA7",children:(0,i.jsxs)("p",{children:["Технічне завдання зафіксоване у ",i.jsx("code",{children:"PROJECT_NOTES.md"}),". Поточний етап — налаштування підключення до Alteg.io API."]})}),i.jsx(l,{title:"Наступні кроки",emoji:"✅",children:(0,i.jsxs)("ol",{style:{margin:0,paddingLeft:22},children:[i.jsx("li",{children:"Перевірити підключення до API (використовується USER_TOKEN)."}),i.jsx("li",{children:"Отримати список компаній (салонів) для тестування."}),i.jsx("li",{children:"Реалізувати базові методи роботи з клієнтами та записами."}),i.jsx("li",{children:"Створити ETL-процес для синхронізації даних."})]})}),i.jsx(l,{title:"Посилання",emoji:"\uD83D\uDD17",children:(0,i.jsxs)("ul",{style:{margin:0,paddingLeft:18},children:[i.jsx("li",{children:i.jsx(o(),{href:"/admin/analytics",style:{color:"#2a6df5"},children:"Перейти до майбутнього дашборду"})}),i.jsx("li",{children:i.jsx(o(),{href:"/admin/debug",style:{color:"#2a6df5"},children:"Відкрити тестову сторінку ManyChat/KeyCRM"})})]})})]}),P.open&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"20px"},onClick:()=>$({open:!1,title:"",content:""}),children:(0,i.jsxs)("div",{style:{backgroundColor:"#fff",borderRadius:12,padding:"24px",maxWidth:"90vw",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)",position:"relative"},onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"},children:[i.jsx("h2",{style:{margin:0,fontSize:"20px",fontWeight:600},children:P.title}),i.jsx("button",{onClick:()=>$({open:!1,title:"",content:""}),style:{background:"none",border:"none",fontSize:"24px",cursor:"pointer",padding:"0 8px",color:"#666"},children:"\xd7"})]}),(0,i.jsxs)("div",{style:{marginBottom:"16px"},children:[i.jsx("button",{onClick:async()=>{let e=P.jsonData?JSON.stringify(P.jsonData,null,2):P.content;await navigator.clipboard.writeText(e),alert("✅ Скопійовано в буфер обміну!")},style:{padding:"8px 16px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontWeight:500,marginRight:"8px"},children:"\uD83D\uDCCB Копіювати JSON"}),i.jsx("button",{onClick:async()=>{await navigator.clipboard.writeText(P.content),alert("✅ Текст скопійовано в буфер обміну!")},style:{padding:"8px 16px",background:"#10b981",color:"#fff",border:"none",borderRadius:6,cursor:"pointer",fontWeight:500},children:"\uD83D\uDCCB Копіювати текст"})]}),i.jsx("div",{style:{backgroundColor:"#f9fafb",padding:"16px",borderRadius:8,fontFamily:"monospace",fontSize:"13px",whiteSpace:"pre-wrap",wordBreak:"break-word",maxHeight:"60vh",overflow:"auto",border:"1px solid #e5e7eb"},children:P.content}),P.jsonData&&(0,i.jsxs)("details",{style:{marginTop:"16px"},children:[i.jsx("summary",{style:{cursor:"pointer",fontWeight:500,marginBottom:"8px"},children:"\uD83D\uDCC4 Показати повний JSON"}),i.jsx("pre",{style:{backgroundColor:"#1f2937",color:"#f9fafb",padding:"16px",borderRadius:8,overflow:"auto",fontSize:"12px",maxHeight:"40vh",marginTop:"8px"},children:JSON.stringify(P.jsonData,null,2)})]})]})})]})}function l({children:e,title:r,emoji:t}){return(0,i.jsxs)("div",{style:{borderRadius:20,border:"1px solid #e8ebf0",background:"#fff",boxShadow:"0 8px 26px rgba(0,0,0,0.06)",padding:"22px 24px"},children:[(0,i.jsxs)("header",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:12},children:[t&&i.jsx("span",{style:{fontSize:28},children:t}),i.jsx("h2",{style:{margin:0,fontSize:24,fontWeight:800},children:r})]}),i.jsx("div",{style:{color:"rgba(0,0,0,0.72)",lineHeight:1.5},children:e})]})}},8838:(e,r,t)=>{"use strict";t.r(r),t.d(r,{$$typeof:()=>s,__esModule:()=>o,default:()=>a});var i=t(8570);let n=(0,i.createProxy)(String.raw`/Users/mykolay/P-3-0/web/app/(admin)/admin/altegio/page.tsx`),{__esModule:o,$$typeof:s}=n;n.default;let a=(0,i.createProxy)(String.raw`/Users/mykolay/P-3-0/web/app/(admin)/admin/altegio/page.tsx#default`)},2675:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c,metadata:()=>d});var i=t(9510),n=t(18),o=t.n(n);t(7272);var s=t(9720);function a(e=globalThis){let r=(e,r)=>{if("get"in e||"set"in e){let t=e.get?e.get.bind(r):void 0,i=e.set?e.set.bind(r):void 0;return{configurable:e.configurable,enumerable:e.enumerable??!1,get:t,set:i}}if("function"==typeof e.value){let t=e.value.bind(r);return{configurable:e.configurable,enumerable:e.enumerable??!1,writable:e.writable??!1,value:t}}return e},t=(e,r,t,i)=>{let n=r?.enumerable??!1;if(r&&("get"in r||"set"in r)){let o=r.get?r.get.bind(i):void 0,s=r.set?r.set.bind(i):void 0;return{configurable:!0,enumerable:n,get:()=>t.has(e)?void 0:o?o():void 0,set:r=>{t.delete(e),s&&s(r)}}}let o=r?r.value:void 0;return{configurable:!0,enumerable:n,get:()=>t.has(e)?void 0:o,set:r=>{t.delete(e),o=r}}};if(!e||e.__p30SymbolGuarded)return;let i=(e=>{let r=e.Symbol;return"function"==typeof r?r:void 0})(e);if(!i){e.__p30SymbolGuarded=!0;return}let n=new Set(["dispose","asyncDispose"]);i.dispose&&n.add(i.dispose),i.asyncDispose&&n.add(i.asyncDispose);let o=new Set,s=function(e){return i(e)};try{Reflect.defineProperty(s,"name",{configurable:!0,enumerable:!1,writable:!1,value:"Symbol"})}catch{}try{Reflect.defineProperty(s,"length",{configurable:!0,enumerable:!1,writable:!1,value:0})}catch{}try{Reflect.defineProperty(s,"prototype",{configurable:!1,enumerable:!1,writable:!1,value:i.prototype})}catch{}for(let e of Reflect.ownKeys(i)){let a=Reflect.getOwnPropertyDescriptor(i,e);if(a){if(n.has(e)){try{Reflect.defineProperty(s,e,t(e,a,o,i))}catch{}continue}try{Reflect.defineProperty(s,e,r(a,i))}catch{}}}Object.defineProperty(s,"__p30ProxyGuard",{configurable:!1,enumerable:!1,writable:!1,value:!0});try{Object.defineProperty(s,Symbol.toStringTag,{configurable:!0,enumerable:!1,writable:!1,value:"Symbol"})}catch{}let a=e=>!!n.has(e)&&(o.add(e),!0),l=new Proxy(s,{apply:(e,r,t)=>Reflect.apply(i,r,t),deleteProperty(e,r){if(a(r)){try{Reflect.deleteProperty(e,r)}catch{}return!0}try{return Reflect.deleteProperty(i,r)}catch{return!1}},get(e,r,t){if("__p30ProxyGuard"===r)return!0;if(n.has(r)){let i=Reflect.getOwnPropertyDescriptor(e,r);return i?"get"in i&&i.get?i.get.call(t):i.value:void 0}let o=Reflect.get(e,r,t);if("function"==typeof o)try{return o.bind(i)}catch{}return o},has:(e,r)=>n.has(r)?!o.has(r)&&Reflect.has(e,r):Reflect.has(e,r)||Reflect.has(i,r),ownKeys(e){let r=[];for(let t of Reflect.ownKeys(e))!(n.has(t)&&o.has(t))&&("string"!=typeof t&&"symbol"!=typeof t||r.includes(t)||r.push(t));return r},getOwnPropertyDescriptor(e,r){if(n.has(r)){if(o.has(r))return;let t=Reflect.getOwnPropertyDescriptor(e,r);return t&&(t.configurable=!0),t}return Reflect.getOwnPropertyDescriptor(e,r)},set:(e,r,t,i)=>(n.has(r)&&o.delete(r),Reflect.set(e,r,t,i)),defineProperty(e,r,s){if(n.has(r)){o.delete(r);let n=t(r,s,o,i);return Reflect.defineProperty(e,r,n)}return Reflect.defineProperty(e,r,s)}});try{Object.defineProperty(e,"Symbol",{configurable:!0,enumerable:!1,writable:!0,value:l})}catch{e.Symbol=l}let d=function(){};try{Object.defineProperty(e,"lockdown",{configurable:!0,enumerable:!1,writable:!0,value:d})}catch{e.lockdown=d}let c=e.ses;if(c)try{Object.defineProperty(c,"lockdown",{configurable:!0,enumerable:!1,writable:!0,value:d})}catch{c.lockdown=d}"function"!=typeof e.harden&&(e.harden=e=>e),e.__p30SymbolGuarded=!0}let l=`;(${a.toString()})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : undefined);`;a();let d={title:"P-3-0",description:"Admin console"};function c({children:e}){return(0,i.jsxs)("html",{lang:"uk",className:o().className,children:[i.jsx("head",{children:i.jsx(s.default,{id:"p30-lockdown-guard",strategy:"beforeInteractive",dangerouslySetInnerHTML:{__html:l}})}),i.jsx("body",{children:e})]})}},7272:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[8948,4818,9404],()=>t(3949));module.exports=i})();