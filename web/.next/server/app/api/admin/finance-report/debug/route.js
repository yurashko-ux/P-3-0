"use strict";(()=>{var e={};e.id=3449,e.ids=[3449],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8389:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>f,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g});var a={};r.r(a),r.d(a,{GET:()=>c,dynamic:()=>u});var n=r(9303),s=r(8716),o=r(670),l=r(7070),i=r(4332);let u="force-dynamic";function p(e,t){return`finance:goods:cost:${e}:${t}`}async function c(e){if(!function(e){let t=e.nextUrl.searchParams.get("secret"),r=process.env.CRON_SECRET||"";return r&&t&&r===t}(e))return l.NextResponse.json({error:"Unauthorized"},{status:401});try{let t=e.nextUrl.searchParams.get("year"),r=e.nextUrl.searchParams.get("month");if(t&&r){let e=parseInt(t,10),a=parseInt(r,10);if(!e||!a||a<1||a>12)return l.NextResponse.json({error:"Invalid year or month"},{status:400});let n=p(e,a),s=await i.kvRead.getRaw(n),o=null;if(null!==s&&"string"==typeof s)try{let e=JSON.parse(s);if("number"==typeof e)o=e;else if("object"==typeof e&&null!==e){let t=e.value??e;o="number"==typeof t?t:"string"==typeof t?parseFloat(t):parseFloat(String(t))}else o="string"==typeof e?parseFloat(e):parseFloat(String(e))}catch{o=parseFloat(s)}return l.NextResponse.json({key:n,year:e,month:a,hasValue:null!==s,rawValue:s,parsedCost:Number.isFinite(o)&&o>=0?o:null})}let a=new Date,n=[];for(let e=0;e<12;e++){let t=new Date(a.getFullYear(),a.getMonth()-e,1),r=t.getFullYear(),s=t.getMonth()+1,o=p(r,s),l=await i.kvRead.getRaw(o),u=null;if(null!==l&&"string"==typeof l)try{let e=JSON.parse(l);if("number"==typeof e)u=e;else if("object"==typeof e&&null!==e){let t=e.value??e;u="number"==typeof t?t:"string"==typeof t?parseFloat(t):parseFloat(String(t))}else u="string"==typeof e?parseFloat(e):parseFloat(String(e))}catch{u=parseFloat(l)}n.push({key:o,year:r,month:s,hasValue:null!==l,rawValue:l,parsedCost:Number.isFinite(u)&&u>=0?u:null})}return l.NextResponse.json({summary:{totalChecked:n.length,withValues:n.filter(e=>e.hasValue).length,withoutValues:n.filter(e=>!e.hasValue).length},results:n})}catch(e){return console.error("[admin/finance-report/debug] GET error:",e),l.NextResponse.json({error:String(e?.message||e)},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/admin/finance-report/debug/route",pathname:"/api/admin/finance-report/debug",filename:"route",bundlePath:"app/api/admin/finance-report/debug/route"},resolvedPagePath:"/Users/mykolay/P-3-0/web/app/api/admin/finance-report/debug/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:m}=d,h="/api/admin/finance-report/debug/route";function y(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:g})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972,4332],()=>r(8389));module.exports=a})();