"use strict";(()=>{var e={};e.id=1796,e.ids=[1796],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5954:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>y,requestAsyncStorage:()=>g,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>f});var i={};r.r(i),r.d(i,{GET:()=>c,dynamic:()=>u,runtime:()=>p});var a=r(9303),s=r(8716),n=r(670),o=r(7070),l=r(1756),m=r(4044);let u="force-dynamic",p="nodejs";async function c(e){try{(0,m.cC)();let t=process.env.ALTEGIO_COMPANY_ID;if(!t)return o.NextResponse.json({ok:!1,error:"ALTEGIO_COMPANY_ID not set in environment variables"},{status:400});let r=parseInt(t,10),i=e.nextUrl.searchParams.get("email");if(!i)return o.NextResponse.json({ok:!1,error:"Email parameter is required. Use ?email=..."},{status:400});console.log(`[altegio/test/clients/by-email] Searching for client with email: ${i}`);let a=await (0,l.Z)(r,100),s=a.find(e=>!!e.email&&e.email.toLowerCase().trim()===i.toLowerCase().trim());if(!s)return o.NextResponse.json({ok:!1,error:`Client with email "${i}" not found`,email:i,searchedClients:a.length},{status:404});let n=null;if(s.email&&s.email.includes("@")){let e=s.email.split("@");e[0]&&e[0].trim()&&(n=e[0].trim())}return o.NextResponse.json({ok:!0,email:i,client:{id:s.id,name:s.name,phone:s.phone,email:s.email,instagramUsername:n,fullStructure:s},note:"Instagram username extracted from email field (part before @)"})}catch(t){console.error("[altegio/test/clients/by-email] Error:",t);let e=t instanceof Error?t.message:String(t);return o.NextResponse.json({ok:!1,error:e},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/altegio/test/clients/by-email/route",pathname:"/api/altegio/test/clients/by-email",filename:"route",bundlePath:"app/api/altegio/test/clients/by-email/route"},resolvedPagePath:"/Users/mykolay/P-3-0/web/app/api/altegio/test/clients/by-email/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:g,staticGenerationAsyncStorage:f,serverHooks:h}=d,x="/api/altegio/test/clients/by-email/route";function y(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:f})}}};var t=require("../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[8948,5972,7582,1756],()=>r(5954));module.exports=i})();