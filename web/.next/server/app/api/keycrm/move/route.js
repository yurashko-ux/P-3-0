"use strict";(()=>{var e={};e.id=1325,e.ids=[1325],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5474:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>v,staticGenerationAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{POST:()=>d});var o=r(9303),a=r(8716),i=r(670),n=r(7070);let p=process.env.KEYCRM_API_BASE||"",u=process.env.KEYCRM_TOKEN||"";async function d(e){try{if(!p||!u)return n.NextResponse.json({ok:!1,error:"KEYCRM env missing"},{status:500});let t=await e.json().catch(()=>({})),r=String(t.card_id||"").trim(),s=String(t.to_pipeline_id||"").trim(),o=String(t.to_status_id||"").trim();if(!r||!s||!o)return n.NextResponse.json({ok:!1,error:"card_id, to_pipeline_id, to_status_id are required"},{status:400});let a=`${p}/crm/deals/${encodeURIComponent(r)}`,i=await fetch(a,{method:"PATCH",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({pipeline_id:s,status_id:o}),cache:"no-store"}),d=await i.text(),c={};try{c=JSON.parse(d)}catch{}if(!i.ok)return n.NextResponse.json({ok:!1,error:c?.message||`${i.status} ${i.statusText}`,raw:c||d},{status:i.status});return n.NextResponse.json({ok:!0,result:c||d})}catch(e){return n.NextResponse.json({ok:!1,error:e?.message||"move failed"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/keycrm/move/route",pathname:"/api/keycrm/move",filename:"route",bundlePath:"app/api/keycrm/move/route"},resolvedPagePath:"/Users/mykolay/P-3-0/web/app/api/keycrm/move/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:l,serverHooks:v}=c,h="/api/keycrm/move/route";function x(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:l})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,5972],()=>r(5474));module.exports=s})();