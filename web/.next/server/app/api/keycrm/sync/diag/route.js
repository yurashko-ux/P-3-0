"use strict";(()=>{var e={};e.id=4149,e.ids=[4149],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8325:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>y,patchFetch:()=>E,requestAsyncStorage:()=>_,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{GET:()=>d,dynamic:()=>u,runtime:()=>p});var n=r(9303),s=r(8716),i=r(670),o=r(7070),c=r(4332);let p="nodejs",u="force-dynamic";async function d(e){if(!function(e){let t=e.headers.get("x-admin-token")||"",r=e.cookies.get("admin_token")?.value||"",a=t||r;return a&&a===process.env.ADMIN_PASS}(e))return o.NextResponse.json({ok:!1,error:"unauthorized"},{status:401});let{searchParams:t}=new URL(e.url),r=t.get("id");try{let e=await c.kvRead.lrange(c.campaignKeys.INDEX_KEY,0,-1),t=null;if(r){let e=await c.kvRead.getRaw(c.campaignKeys.ITEM_KEY(r));if(e)try{t=JSON.parse(e)}catch{t={parseError:!0,raw:e}}}return o.NextResponse.json({ok:!0,time:new Date().toISOString(),indexKey:c.campaignKeys.INDEX_KEY,totalIds:e.length,head:e.slice(0,10),inspectId:r||null,item:t,env:{KV_REST_API_URL:!!process.env.KV_REST_API_URL,KV_REST_API_TOKEN:!!process.env.KV_REST_API_TOKEN,KV_REST_API_READ_ONLY_TOKEN:!!process.env.KV_REST_API_READ_ONLY_TOKEN}})}catch(e){return o.NextResponse.json({ok:!1,error:e?.message||"diag failed"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/keycrm/sync/diag/route",pathname:"/api/keycrm/sync/diag",filename:"route",bundlePath:"app/api/keycrm/sync/diag/route"},resolvedPagePath:"/Users/mykolay/P-3-0/web/app/api/keycrm/sync/diag/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:_,staticGenerationAsyncStorage:m,serverHooks:g}=l,y="/api/keycrm/sync/diag/route";function E(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972,4332],()=>r(8325));module.exports=a})();