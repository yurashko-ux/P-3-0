"use strict";(()=>{var e={};e.id=4712,e.ids=[4712],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1966:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{GET:()=>c,dynamic:()=>p});var a=r(9303),i=r(8716),n=r(670),o=r(7070);let p="force-dynamic";async function c(e){let t;let r=new URL(e.url),s=r.searchParams.get("admin")??"",a=e.headers.get("authorization")??"",i=a.startsWith("Bearer ")?a.slice(7).trim():a.trim(),n=process.env.ADMIN_PASS??"";if(!n||s!==n&&i!==n)return o.NextResponse.json({ok:!1,error:"Unauthorized"},{status:401});let p=r.searchParams.get("pipeline_id"),c=r.searchParams.get("status_id"),u=r.searchParams.get("page")??"1",d=r.searchParams.get("per_page")??"50";if(!p||!c)return o.NextResponse.json({ok:!1,error:"pipeline_id and status_id are required"},{status:400});let l=(process.env.KEYCRM_BASE_URL||"https://openapi.keycrm.app/v1").replace(/\/+$/,""),m=process.env.KEYCRM_API_TOKEN;if(!m)return o.NextResponse.json({ok:!1,error:"Missing KEYCRM_API_TOKEN env"},{status:500});let h=new URLSearchParams({page:u,per_page:d,pipeline_id:String(p),status_id:String(c)}),g=`${l}/pipelines/cards?${h.toString()}`,k=await fetch(g,{method:"GET",headers:{Authorization:`Bearer ${m}`,Accept:"application/json","Content-Type":"application/json"},cache:"no-store"}),y=await k.text();try{t=y?JSON.parse(y):{}}catch{t={raw:y}}return k.ok?o.NextResponse.json({ok:!0,url:g,data:t}):o.NextResponse.json({ok:!1,status:k.status,error:t?.message||t||"KeyCRM request failed"},{status:k.status})}let u=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/keycrm/test/cards/route",pathname:"/api/keycrm/test/cards",filename:"route",bundlePath:"app/api/keycrm/test/cards/route"},resolvedPagePath:"/Users/mykolay/P-3-0/web/app/api/keycrm/test/cards/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:m}=u,h="/api/keycrm/test/cards/route";function g(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[8948,5972],()=>r(1966));module.exports=s})();