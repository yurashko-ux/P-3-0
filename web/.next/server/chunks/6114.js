exports.id=6114,exports.ids=[6114],exports.modules={6847:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},5800:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,4064,23))},38:(e,t,r)=>{"use strict";r.d(t,{R:()=>a});var l=r(326),n=r(7577);function a({storageKey:e,layoutVersion:t,defaultLayout:r,children:a,cols:o=12,minHeight:s=20,containerPadding:i=48,editMode:u=!1,onSave:c}){let[d,f]=(0,n.useState)(r),[h,b]=(0,n.useState)(1200),[y,p]=(0,n.useState)(null),[g,m]=(0,n.useState)(null),[x,v]=(0,n.useState)(null),[w,S]=(0,n.useState)({x:0,y:0}),[P,R]=(0,n.useState)({x:0,y:0,w:0,h:0}),j=(0,n.useRef)(null),D=(0,n.useRef)({}),N=h/o;(0,n.useCallback)(e=>{let t=[...e].sort((e,t)=>e.y-t.y),r=[];return t.forEach((e,t)=>{if(0===t)r.push(e);else{let t=r.filter(t=>{let r=e.x+e.w,l=t.x+t.w;return!(r<=t.x||e.x>=l)});if(t.length>0){let l=Math.max(...t.map(e=>e.y+e.h)),n=Math.max(e.y,l);r.push({...e,y:n})}else r.push(e)}}),r},[]),(0,n.useCallback)(t=>{f(t),u&&(localStorage.setItem(e,JSON.stringify(t)),c&&c(t))},[e,u,c]);let C=(0,n.useRef)(d),k=(e,t,r)=>{if(!j.current)return;let l=j.current.getBoundingClientRect(),n=C.current.find(e=>e.i===t);if(n){if("drag"===r){p(t);let r={left:n.x*N,top:n.y};S({x:e.clientX-l.left-r.left,y:e.clientY-l.top-r.top})}else m(t),v("resize-height"===r?"height":"resize-width"===r?"width":"both"),R({x:e.clientX,y:e.clientY,w:n.w,h:n.h});e.preventDefault(),e.stopPropagation()}};return l.jsx("div",{ref:j,className:"relative",style:{width:"100%",minHeight:"100vh"},children:d.map(e=>{let t=a[e.i];return t?(0,l.jsxs)("div",{className:"absolute",style:{left:`${e.x*N}px`,top:`${e.y}px`,width:`${e.w*N}px`,height:`${e.h}px`,zIndex:y===e.i||g===e.i?1e3:1},children:[u&&l.jsx("div",{className:"drag-handle absolute top-0 left-0 right-0 h-6 bg-blue-500 bg-opacity-10 cursor-move flex items-center justify-center text-xs text-gray-500 hover:bg-opacity-20 z-10",onMouseDown:t=>k(t,e.i,"drag"),children:"⋮⋮ Перетягніть"}),u&&(0,l.jsxs)(l.Fragment,{children:[l.jsx("div",{className:"absolute bottom-0 right-0 w-6 h-6 cursor-se-resize z-10",onMouseDown:t=>k(t,e.i,"resize-both"),style:{background:"linear-gradient(-45deg, transparent 30%, rgba(59, 130, 246, 0.3) 30%, rgba(59, 130, 246, 0.3) 50%, transparent 50%)"}}),l.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-3 cursor-s-resize z-10",onMouseDown:t=>k(t,e.i,"resize-height"),style:{background:"linear-gradient(to bottom, transparent, rgba(59, 130, 246, 0.2))"}}),l.jsx("div",{className:"absolute top-0 bottom-0 right-0 w-3 cursor-e-resize z-10",onMouseDown:t=>k(t,e.i,"resize-width"),style:{background:"linear-gradient(to right, transparent, rgba(59, 130, 246, 0.2))"}})]}),l.jsx("div",{ref:t=>{t&&(D.current[e.i]=t)},className:`h-full overflow-auto ${u?"pt-6":""}`,style:{minHeight:"100%"},children:t})]},e.i):null})})}},8478:(e,t,r)=>{"use strict";r.d(t,{G:()=>o});var l=r(326),n=r(7577),a=r(5047);function o({storageKey:e,onEditModeChange:t,onSave:r}){let o=(0,a.useRouter)(),[s,i]=(0,n.useState)(!1),[u,c]=(0,n.useState)(""),[d,f]=(0,n.useTransition)(),[h,b]=(0,n.useState)(null),[y,p]=(0,n.useState)(null),g=(0,n.useCallback)(t=>{u&&(b(null),f(async()=>{try{let l=await fetch(`/api/admin/dashboard-layout?secret=${encodeURIComponent(u)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storageKey:e,layout:t})});if(!l.ok){let e=await l.json();throw Error(e.error||"Помилка збереження")}let n=await l.json();console.log("[EditLayoutButton] Saved layout:",n),p(`✅ Layout збережено (${t.length} блоків)`),b(null),r&&r(t),o.refresh(),setTimeout(()=>{p(null)},3e3)}catch(e){console.error("[EditLayoutButton] Save error:",e),b(e.message||"Помилка збереження")}}))},[u,e,r,o]);return(0,l.jsxs)("div",{className:"space-y-2",children:[s?(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:()=>{i(!1),c(""),t(!1),b(null),p(null)},className:"btn btn-sm btn-ghost text-xs",disabled:d,children:"\uD83D\uDD12 Заблокувати"}),l.jsx("span",{className:"text-xs text-green-600 font-semibold",children:"✓ Режим редагування активний"})]}),l.jsx("button",{onClick:()=>{let t=localStorage.getItem(e);if(t)try{let e=JSON.parse(t);g(e)}catch(e){b("Помилка читання layout з localStorage")}else b("Layout не знайдено в localStorage")},className:"btn btn-sm btn-primary text-xs font-semibold",disabled:d,children:d?"Збереження...":"\uD83D\uDCBE Зберегти layout"})]}):l.jsx("button",{onClick:()=>{let r=prompt(`Введіть CRON_SECRET для редагування layout дашборду:`);r&&fetch(`/api/admin/dashboard-layout?secret=${encodeURIComponent(r)}&storageKey=${encodeURIComponent(e)}`).then(e=>{e.ok?(i(!0),c(r),t(!0)):alert("Невірний CRON_SECRET")}).catch(e=>{console.error("Failed to verify secret:",e),alert("Помилка перевірки секрету")})},className:"btn btn-sm btn-outline text-xs font-semibold",title:`Розблокувати для редагування layout (потрібен CRON_SECRET)`,children:"\uD83D\uDD13 Редагувати layout"}),h&&l.jsx("div",{className:"text-xs text-error bg-error/10 p-1 rounded",children:h}),y&&l.jsx("div",{className:"text-xs text-success bg-success/10 p-1 rounded",children:y}),s&&l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:'\uD83D\uDCA1 Перемістіть та змініть розмір блоків, потім натисніть "Зберегти layout"'})]})}},5047:(e,t,r)=>{"use strict";var l=r(7389);r.o(l,"useParams")&&r.d(t,{useParams:function(){return l.useParams}}),r.o(l,"useRouter")&&r.d(t,{useRouter:function(){return l.useRouter}}),r.o(l,"useSearchParams")&&r.d(t,{useSearchParams:function(){return l.useSearchParams}})},2675:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,metadata:()=>u});var l=r(9510),n=r(18),a=r.n(n);r(7272);var o=r(9720);function s(e=globalThis){let t=(e,t)=>{if("get"in e||"set"in e){let r=e.get?e.get.bind(t):void 0,l=e.set?e.set.bind(t):void 0;return{configurable:e.configurable,enumerable:e.enumerable??!1,get:r,set:l}}if("function"==typeof e.value){let r=e.value.bind(t);return{configurable:e.configurable,enumerable:e.enumerable??!1,writable:e.writable??!1,value:r}}return e},r=(e,t,r,l)=>{let n=t?.enumerable??!1;if(t&&("get"in t||"set"in t)){let a=t.get?t.get.bind(l):void 0,o=t.set?t.set.bind(l):void 0;return{configurable:!0,enumerable:n,get:()=>r.has(e)?void 0:a?a():void 0,set:t=>{r.delete(e),o&&o(t)}}}let a=t?t.value:void 0;return{configurable:!0,enumerable:n,get:()=>r.has(e)?void 0:a,set:t=>{r.delete(e),a=t}}};if(!e||e.__p30SymbolGuarded)return;let l=(e=>{let t=e.Symbol;return"function"==typeof t?t:void 0})(e);if(!l){e.__p30SymbolGuarded=!0;return}let n=new Set(["dispose","asyncDispose"]);l.dispose&&n.add(l.dispose),l.asyncDispose&&n.add(l.asyncDispose);let a=new Set,o=function(e){return l(e)};try{Reflect.defineProperty(o,"name",{configurable:!0,enumerable:!1,writable:!1,value:"Symbol"})}catch{}try{Reflect.defineProperty(o,"length",{configurable:!0,enumerable:!1,writable:!1,value:0})}catch{}try{Reflect.defineProperty(o,"prototype",{configurable:!1,enumerable:!1,writable:!1,value:l.prototype})}catch{}for(let e of Reflect.ownKeys(l)){let s=Reflect.getOwnPropertyDescriptor(l,e);if(s){if(n.has(e)){try{Reflect.defineProperty(o,e,r(e,s,a,l))}catch{}continue}try{Reflect.defineProperty(o,e,t(s,l))}catch{}}}Object.defineProperty(o,"__p30ProxyGuard",{configurable:!1,enumerable:!1,writable:!1,value:!0});try{Object.defineProperty(o,Symbol.toStringTag,{configurable:!0,enumerable:!1,writable:!1,value:"Symbol"})}catch{}let s=e=>!!n.has(e)&&(a.add(e),!0),i=new Proxy(o,{apply:(e,t,r)=>Reflect.apply(l,t,r),deleteProperty(e,t){if(s(t)){try{Reflect.deleteProperty(e,t)}catch{}return!0}try{return Reflect.deleteProperty(l,t)}catch{return!1}},get(e,t,r){if("__p30ProxyGuard"===t)return!0;if(n.has(t)){let l=Reflect.getOwnPropertyDescriptor(e,t);return l?"get"in l&&l.get?l.get.call(r):l.value:void 0}let a=Reflect.get(e,t,r);if("function"==typeof a)try{return a.bind(l)}catch{}return a},has:(e,t)=>n.has(t)?!a.has(t)&&Reflect.has(e,t):Reflect.has(e,t)||Reflect.has(l,t),ownKeys(e){let t=[];for(let r of Reflect.ownKeys(e))!(n.has(r)&&a.has(r))&&("string"!=typeof r&&"symbol"!=typeof r||t.includes(r)||t.push(r));return t},getOwnPropertyDescriptor(e,t){if(n.has(t)){if(a.has(t))return;let r=Reflect.getOwnPropertyDescriptor(e,t);return r&&(r.configurable=!0),r}return Reflect.getOwnPropertyDescriptor(e,t)},set:(e,t,r,l)=>(n.has(t)&&a.delete(t),Reflect.set(e,t,r,l)),defineProperty(e,t,o){if(n.has(t)){a.delete(t);let n=r(t,o,a,l);return Reflect.defineProperty(e,t,n)}return Reflect.defineProperty(e,t,o)}});try{Object.defineProperty(e,"Symbol",{configurable:!0,enumerable:!1,writable:!0,value:i})}catch{e.Symbol=i}let u=function(){};try{Object.defineProperty(e,"lockdown",{configurable:!0,enumerable:!1,writable:!0,value:u})}catch{e.lockdown=u}let c=e.ses;if(c)try{Object.defineProperty(c,"lockdown",{configurable:!0,enumerable:!1,writable:!0,value:u})}catch{c.lockdown=u}"function"!=typeof e.harden&&(e.harden=e=>e),e.__p30SymbolGuarded=!0}let i=`;(${s.toString()})(typeof globalThis !== "undefined" ? globalThis : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : undefined);`;s();let u={title:"P-3-0",description:"Admin console"};function c({children:e}){return(0,l.jsxs)("html",{lang:"uk",className:a().className,children:[l.jsx("head",{children:l.jsx(o.default,{id:"p30-lockdown-guard",strategy:"beforeInteractive",dangerouslySetInnerHTML:{__html:i}})}),l.jsx("body",{children:e})]})}},7272:()=>{}};